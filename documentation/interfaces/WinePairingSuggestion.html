<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>cave-master-frontend documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css">
    </head>
    <body>
          <script>
               // Blocking script to avoid flickering dark mode
               // Dark mode toggle button
               var useDark = window.matchMedia('(prefers-color-scheme: dark)');
               var darkModeState = useDark.matches;
               var $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               var $darkModeToggles = document.querySelectorAll('.dark-mode-switch');
               var darkModeStateLocal = localStorage.getItem('compodoc_darkmode-state');

               function checkToggle(check) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].checked = check;
                    }
               }

               function toggleDarkMode(state) {
                    if (window.localStorage) {
                         localStorage.setItem('compodoc_darkmode-state', state);
                    }

                    checkToggle(state);

                    const hasClass = document.body.classList.contains('dark');

                    if (state) {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.add('dark');
                         }
                         if (!hasClass) {
                              document.body.classList.add('dark');
                         }
                    } else {
                         for (var i = 0; i < $darkModeToggles.length; i++) {
                              $darkModeToggles[i].classList.remove('dark');
                         }
                         if (hasClass) {
                              document.body.classList.remove('dark');
                         }
                    }
               }

               useDark.addEventListener('change', function (evt) {
                    toggleDarkMode(evt.matches);
               });
               if (darkModeStateLocal) {
                    darkModeState = darkModeStateLocal === 'true';
               }
               toggleDarkMode(darkModeState);
          </script>
          <script>
              // --- Iframe navigation tracking for Template Playground ---
              function sendCurrentUrlToParent() {
                  if (window.parent && window.parent !== window) {
                      window.parent.postMessage({
                          type: 'compodoc-iframe-navigate',
                          url: window.location.pathname + window.location.hash
                      }, '*');
                  }
              }
              window.addEventListener('hashchange', sendCurrentUrlToParent, false);
              window.addEventListener('popstate', sendCurrentUrlToParent, false);
              window.addEventListener('DOMContentLoaded', sendCurrentUrlToParent, false);
          </script>

        <div class="navbar navbar-default navbar-fixed-top d-md-none p-0">
               <div class="d-flex">
                    <a href="../" class="navbar-brand">cave-master-frontend documentation</a>
                    <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
               </div>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="d-none d-md-block menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">

















<ol class="breadcrumb">
  <li class="breadcrumb-item">Interfaces</li>
  <li class="breadcrumb-item"
  >
  WinePairingSuggestion</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
            <a href="#info" 
                class="nav-link"
                class="nav-link active"
                role="tab" id="info-tab" data-bs-toggle="tab" data-link="info">Info</a>
        </li>
        <li class="nav-item">
            <a href="#source" 
                class="nav-link"
                
                role="tab" id="source-tab" data-bs-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/app/view/admin-dashboard/entries/entries.component.ts</code>
        </p>


            <p class="comment">
                <h3>Description</h3>
            </p>
            <p class="comment">
                <p>Interface pour les accords mets-vins sugg√©r√©s
Int√©gration avec wine-pairing</p>

            </p>


        <section data-compodoc="block-index">
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#description" 
>
                                            description
                                        </a>
                                </li>
                                <li>
                                        <a href="#dish" 
>
                                            dish
                                        </a>
                                </li>
                                <li>
                                        <a href="#dishIcon" 
>
                                            dishIcon
                                        </a>
                                </li>
                                <li>
                                        <a href="#temperature" 
>
                                            temperature
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section data-compodoc="block-properties">
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="description"></a>
                                        <span class="name "><b>description</b>
                                            <a href="#description">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>description:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="dish"></a>
                                        <span class="name "><b>dish</b>
                                            <a href="#dish">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>dish:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="dishIcon"></a>
                                        <span class="name "><b>dishIcon</b>
                                            <a href="#dishIcon">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>dishIcon:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="temperature"></a>
                                        <span class="name "><b>temperature</b>
                                            <a href="#temperature">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>temperature:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Component, OnInit } from &#x27;@angular/core&#x27;;
import { CommonModule } from &#x27;@angular/common&#x27;;
import { FormsModule, ReactiveFormsModule } from &#x27;@angular/forms&#x27;;

/**
 * √ânum√©rations import√©es depuis drinks.component
 */
export enum DrinkCategory {
  BIERES &#x3D; &#x27;Bi√®res&#x27;,
  SUCRERIES &#x3D; &#x27;Sucreries&#x27;,
  CHAMPAGNE &#x3D; &#x27;Champagne&#x27;,
  VIN_BLANC &#x3D; &#x27;Vin Blanc&#x27;,
  VIN_ROUGE &#x3D; &#x27;Vin Rouge&#x27;,
  VIN_ROSE &#x3D; &#x27;Vin Ros√©&#x27;,
  VIN_MOUSSEUX &#x3D; &#x27;Vin Mousseux&#x27;,
  LIQUEURS &#x3D; &#x27;Liqueurs&#x27;,
  BOISSONS_ENERGISANTES &#x3D; &#x27;Boissons √ânergisantes&#x27;,
  BOISSONS_LOCALES &#x3D; &#x27;Boissons Locales&#x27;
}

export enum DrinkFormat {
  CL_25 &#x3D; &#x27;25cl&#x27;,
  CL_33 &#x3D; &#x27;33cl&#x27;,
  CL_50 &#x3D; &#x27;50cl&#x27;,
  CL_65 &#x3D; &#x27;65cl&#x27;,
  CL_75 &#x3D; &#x27;75cl&#x27;,
  L_1 &#x3D; &#x27;1L&#x27;,
  L_1_5 &#x3D; &#x27;1.5L&#x27;,
  L_2 &#x3D; &#x27;2L&#x27;
}

export enum Supplier {
  SOLIBRA &#x3D; &#x27;Solibra&#x27;,
  BRASSIVOIRE &#x3D; &#x27;Brassivoire&#x27;,
  SICOBRA &#x3D; &#x27;Sicobra&#x27;,
  UNIBRA &#x3D; &#x27;Unibra&#x27;,
  AUTRES &#x3D; &#x27;Autres&#x27;
}

export enum PackagingType {
  BOUTEILLE &#x3D; &#x27;Bouteille&#x27;,
  CANETTE &#x3D; &#x27;Canette&#x27;,
  VERRE &#x3D; &#x27;Verre&#x27;,
  PLASTIQUE &#x3D; &#x27;Plastique&#x27;,
  SACHET &#x3D; &#x27;Sachet&#x27;
}

export enum BulkUnit {
  CARTON &#x3D; &#x27;Carton&#x27;,
  CASIER &#x3D; &#x27;Casier&#x27;,
  PACK &#x3D; &#x27;Pack&#x27;,
  CAISSE &#x3D; &#x27;Caisse&#x27;
}

/**
 * Interface pour d√©finir une boisson compl√®te
 * Cette interface contient TOUS les d√©tails d&#x27;une boisson
 */
interface Drink {
  // Identifiants
  id: string;
  name: string;
  icon: string;

  // Caract√©ristiques produit
  category: DrinkCategory;
  format: DrinkFormat;
  packagingType: PackagingType;

  // Informations fournisseur et commercial
  supplier: Supplier;
  depot: string;                    // Nom du d√©p√¥t
  commercialName: string;           // Nom du commercial
  commercialContact: string;        // Contact du commercial

  // Conditionnement en gros
  bulkUnit: BulkUnit;              // Unit√© de gros (Carton, Casier...)
  bulkQuantity: number;            // Nombre d&#x27;unit√©s de gros
  unitsPerBulk: number;            // Unit√©s par conditionnement
  totalBottles: number;            // Total calcul√© automatiquement

  // Tarification
  purchasePrice: number;           // Prix d&#x27;achat unitaire
  sellingPrice: number;            // Prix de vente unitaire

  // Stock et ventes
  stock: number;
  sales?: number;

  // Informations compl√©mentaires
  description?: string;
  createdAt?: Date;
  badge?: &#x27;hot&#x27; | &#x27;new&#x27;;
}

/**
 * Interface pour d√©finir une cave
 */
interface Cave {
  id: string;
  name: string;
  location: string;
  capacity: number;
  currentStock: number;
  description?: string;
  temperature?: string;           // Temp√©rature de conservation
  humidity?: string;              // Taux d&#x27;humidit√©
}

/**
 * Interface pour d√©finir une entr√©e de stock enrichie
 * Maintenant avec TOUS les d√©tails de la boisson
 */
interface StockEntry {
  // Identifiants
  id: string;
  date: Date;

  // Informations boisson
  drinkId: string;
  drinkName: string;
  drinkIcon: string;
  drinkCategory: DrinkCategory;
  drinkFormat: DrinkFormat;

  // Conditionnement re√ßu
  bulkUnit: BulkUnit;              // Type de conditionnement re√ßu
  bulkQuantity: number;            // Nombre de conditionnements re√ßus
  unitsPerBulk: number;            // Unit√©s par conditionnement
  quantity: number;                // Quantit√© totale d&#x27;unit√©s

  // Informations fournisseur
  supplier: Supplier;
  supplierInvoice?: string;        // Num√©ro de facture fournisseur
  deliveryNote?: string;           // Num√©ro de bon de livraison

  // Commercial associ√©
  commercialName: string;
  commercialContact: string;

  // Tarification
  unitPrice: number;               // Prix d&#x27;achat unitaire
  bulkPrice: number;               // Prix par conditionnement
  totalCost: number;               // Co√ªt total de l&#x27;entr√©e

  // Destination
  caveId: string;

  // Qualit√© et conformit√©
  qualityCheck: &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;;
  qualityNotes?: string;

  // Tra√ßabilit√©
  addedBy: string;
  batchNumber?: string;            // Num√©ro de lot
  expiryDate?: Date;               // Date de p√©remption si applicable

  // Notes
  notes?: string;
}

/**
 * Interface pour le formulaire d&#x27;entr√©e enrichi
 */
interface StockEntryForm {
  // S√©lection boisson
  drinkId: string;

  // Conditionnement
  bulkUnit: BulkUnit;
  bulkQuantity: number;
  unitsPerBulk: number;
  totalUnits: number;              // Calcul√© automatiquement

  // Tarification
  unitPrice: number;
  bulkPrice: number;               // Calcul√© automatiquement
  totalCost: number;               // Calcul√© automatiquement

  // Fournisseur et documents
  supplier: Supplier;
  supplierInvoice: string;
  deliveryNote: string;

  // Destination
  caveId: string;

  // Qualit√©
  qualityCheck: &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;;
  qualityNotes: string;

  // Tra√ßabilit√©
  batchNumber: string;
  expiryDate: string;

  // Notes
  notes: string;
}

/**
 * Interface pour les accords mets-vins sugg√©r√©s
 * Int√©gration avec wine-pairing
 */
interface WinePairingSuggestion {
  dish: string;
  dishIcon: string;
  description: string;
  temperature: string;
}

/**
 * Composant EntriesComponent - VERSION ENRICHIE
 * Gestion compl√®te des entr√©es de stock avec tous les d√©tails
 */
@Component({
  selector: &#x27;app-entries&#x27;,
  standalone: true,
  imports: [CommonModule, FormsModule, ReactiveFormsModule],
  templateUrl: &#x27;./entries.component.html&#x27;,
  styleUrls: [&#x27;./entries.component.scss&#x27;]
})
export class EntriesComponent implements OnInit {

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // PROPRI√âT√âS
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Liste compl√®te des entr√©es de stock
   */
  entries: StockEntry[] &#x3D; [];

  /**
   * Liste filtr√©e des entr√©es √† afficher
   */
  filteredEntries: StockEntry[] &#x3D; [];

  /**
   * Liste des boissons disponibles (avec d√©tails complets)
   */
  drinks: Drink[] &#x3D; [];

  /**
   * Liste des caves disponibles
   */
  caves: Cave[] &#x3D; [];

  /**
   * Indicateur de chargement
   */
  isLoading: boolean &#x3D; false;

  /**
   * Indique si le modal d&#x27;ajout est ouvert
   */
  isAddModalOpen: boolean &#x3D; false;

  /**
   * Indique si le modal de d√©tails est ouvert
   */
  isDetailModalOpen: boolean &#x3D; false;

  /**
   * Entr√©e s√©lectionn√©e pour afficher les d√©tails
   */
  selectedEntry: StockEntry | null &#x3D; null;

  /**
   * Formulaire pour ajouter une entr√©e
   */
  entryForm: StockEntryForm &#x3D; this.getEmptyForm();

  /**
   * Filtres
   */
  selectedCaveFilter: string | null &#x3D; null;
  selectedCategoryFilter: DrinkCategory | null &#x3D; null;
  selectedSupplierFilter: Supplier | null &#x3D; null;
  periodFilter: number &#x3D; 30; // 30 derniers jours par d√©faut
  searchTerm: string &#x3D; &#x27;&#x27;;

  /**
   * √ânum√©rations pour le template
   */
  drinkCategories &#x3D; Object.values(DrinkCategory);
  suppliers &#x3D; Object.values(Supplier);
  bulkUnits &#x3D; Object.values(BulkUnit);
  qualityOptions: Array&lt;&#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;&gt; &#x3D; [
    &#x27;conforme&#x27;,
    &#x27;non-conforme&#x27;,
    &#x27;avec-reserve&#x27;
  ];

  /**
   * Statistiques enrichies des entr√©es
   */
  stats &#x3D; {
    totalEntries: 0,              // Nombre total d&#x27;entr√©es
    totalQuantity: 0,             // Quantit√© totale d&#x27;unit√©s re√ßues
    totalCost: 0,                 // Co√ªt total des entr√©es
    recentEntries: 0,             // Entr√©es des 7 derniers jours
    averageUnitPrice: 0,          // Prix unitaire moyen
    totalBulkUnits: 0,            // Nombre total de conditionnements re√ßus
    conformityRate: 0,            // Taux de conformit√© (%)
    topSupplier: &#x27;&#x27;,              // Fournisseur principal
    topCategory: &#x27;&#x27;               // Cat√©gorie la plus re√ßue
  };

  /**
   * Suggestions d&#x27;accords mets-vins pour la boisson s√©lectionn√©e
   */
  winePairingSuggestions: WinePairingSuggestion[] &#x3D; [];

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // CONSTRUCTEUR
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  constructor() {}

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // LIFECYCLE HOOKS
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Initialisation du composant
   * Charge toutes les donn√©es au d√©marrage
   */
  ngOnInit(): void {
    console.log(&#x27;‚úÖ EntriesComponent initialis√© avec d√©tails complets&#x27;);
    this.loadData();
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // CHARGEMENT DES DONN√âES
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Charge toutes les donn√©es n√©cessaires
   * TODO: Remplacer par des appels API r√©els
   */
  loadData(): void {
    // Cette ligne active l&#x27;indicateur de chargement pour informer l&#x27;utilisateur
    this.isLoading &#x3D; true;

    // On charge d&#x27;abord les boissons avec TOUS leurs d√©tails (format, conditionnement, commercial, etc.)
    this.drinks &#x3D; this.generateMockDrinks();

    // Ensuite on charge les caves disponibles pour le stockage
    this.caves &#x3D; this.generateMockCaves();

    // Enfin on charge l&#x27;historique des entr√©es de stock
    this.entries &#x3D; this.generateMockEntries();

    // On initialise les entr√©es filtr√©es avec toutes les entr√©es
    this.filteredEntries &#x3D; [...this.entries];

    // On calcule toutes les statistiques (total, co√ªts, conformit√©, etc.)
    this.calculateStats();

    // Le chargement est termin√©
    this.isLoading &#x3D; false;

    // Log pour le debug : affiche le nombre d&#x27;√©l√©ments charg√©s
    console.log(&#x27;‚úÖ Donn√©es charg√©es:&#x27;, {
      entries: this.entries.length,
      drinks: this.drinks.length,
      caves: this.caves.length
    });
  }

  /**
   * G√©n√®re des boissons de test AVEC TOUS LES D√âTAILS
   * Chaque boisson contient maintenant les informations compl√®tes
   * @returns Liste de boissons simul√©es avec d√©tails complets
   */
  private generateMockDrinks(): Drink[] {
    // On retourne un tableau de boissons avec TOUS les champs remplis
    return [
      {
        // &#x3D;&#x3D;&#x3D; IDENTIFIANTS &#x3D;&#x3D;&#x3D;
        id: &#x27;drink_1&#x27;,                              // ID unique de la boisson
        name: &#x27;Heineken&#x27;,                           // Nom commercial
        icon: &#x27;üç∫&#x27;,                                 // Emoji pour l&#x27;affichage

        // &#x3D;&#x3D;&#x3D; CARACT√âRISTIQUES PRODUIT &#x3D;&#x3D;&#x3D;
        category: DrinkCategory.BIERES,             // Cat√©gorie : Bi√®re
        format: DrinkFormat.CL_33,                  // Format : 33cl
        packagingType: PackagingType.BOUTEILLE,     // Type : Bouteille en verre

        // &#x3D;&#x3D;&#x3D; FOURNISSEUR ET COMMERCIAL &#x3D;&#x3D;&#x3D;
        supplier: Supplier.SOLIBRA,                 // Fournisseur : Solibra
        depot: &#x27;D√©p√¥t Abidjan Zone 4&#x27;,             // Localisation du d√©p√¥t
        commercialName: &#x27;Kouadio Jean&#x27;,             // Nom du commercial responsable
        commercialContact: &#x27;+225 07 00 00 00 01&#x27;,   // T√©l√©phone du commercial

        // &#x3D;&#x3D;&#x3D; CONDITIONNEMENT EN GROS &#x3D;&#x3D;&#x3D;
        bulkUnit: BulkUnit.CARTON,                  // On commande par carton
        bulkQuantity: 3,                            // 3 cartons
        unitsPerBulk: 12,                           // 12 bouteilles par carton
        totalBottles: 36,                           // Total : 3 √ó 12 &#x3D; 36 bouteilles

        // &#x3D;&#x3D;&#x3D; TARIFICATION &#x3D;&#x3D;&#x3D;
        purchasePrice: 650,                         // Prix d&#x27;achat : 650 FCFA/bouteille
        sellingPrice: 800,                          // Prix de vente : 800 FCFA/bouteille

        // &#x3D;&#x3D;&#x3D; STOCK ET VENTES &#x3D;&#x3D;&#x3D;
        stock: 150,                                 // Stock actuel : 150 unit√©s
        sales: 450,                                 // Ventes totales : 450 unit√©s

        // &#x3D;&#x3D;&#x3D; INFORMATIONS COMPL√âMENTAIRES &#x3D;&#x3D;&#x3D;
        description: &#x27;Bi√®re blonde hollandaise premium&#x27;,
        createdAt: new Date(),
        badge: &#x27;hot&#x27;                                // Badge &quot;hot&quot; &#x3D; produit populaire
      },
      {
        id: &#x27;drink_2&#x27;,
        name: &#x27;Bordeaux Rouge 2018&#x27;,
        icon: &#x27;üç∑&#x27;,

        category: DrinkCategory.VIN_ROUGE,
        format: DrinkFormat.CL_75,
        packagingType: PackagingType.BOUTEILLE,

        supplier: Supplier.AUTRES,
        depot: &#x27;D√©p√¥t Cocody&#x27;,
        commercialName: &#x27;Bakayoko Aminata&#x27;,
        commercialContact: &#x27;+225 05 00 00 00 02&#x27;,

        bulkUnit: BulkUnit.CAISSE,
        bulkQuantity: 2,
        unitsPerBulk: 6,
        totalBottles: 12,

        purchasePrice: 12000,
        sellingPrice: 15000,

        stock: 45,
        sales: 120,

        description: &#x27;Vin rouge de Bordeaux, mill√©sime 2018, appellation contr√¥l√©e&#x27;,
        createdAt: new Date()
      },
      {
        id: &#x27;drink_3&#x27;,
        name: &#x27;Champagne Mo√´t &amp; Chandon&#x27;,
        icon: &#x27;üçæ&#x27;,

        category: DrinkCategory.CHAMPAGNE,
        format: DrinkFormat.CL_75,
        packagingType: PackagingType.BOUTEILLE,

        supplier: Supplier.AUTRES,
        depot: &#x27;D√©p√¥t Plateau&#x27;,
        commercialName: &#x27;Kon√© Moussa&#x27;,
        commercialContact: &#x27;+225 07 11 22 33 44&#x27;,

        bulkUnit: BulkUnit.CAISSE,
        bulkQuantity: 1,
        unitsPerBulk: 6,
        totalBottles: 6,

        purchasePrice: 30000,
        sellingPrice: 35000,

        stock: 20,
        sales: 85,

        description: &#x27;Champagne brut imp√©rial, cuv√©e prestige&#x27;,
        createdAt: new Date(),
        badge: &#x27;new&#x27;
      },
      {
        id: &#x27;drink_4&#x27;,
        name: &#x27;Guinness&#x27;,
        icon: &#x27;üç∫&#x27;,

        category: DrinkCategory.BIERES,
        format: DrinkFormat.CL_33,
        packagingType: PackagingType.CANETTE,

        supplier: Supplier.BRASSIVOIRE,
        depot: &#x27;D√©p√¥t Yopougon&#x27;,
        commercialName: &#x27;Traor√© Sekou&#x27;,
        commercialContact: &#x27;+225 01 55 66 77 88&#x27;,

        bulkUnit: BulkUnit.PACK,
        bulkQuantity: 2,
        unitsPerBulk: 24,
        totalBottles: 48,

        purchasePrice: 850,
        sellingPrice: 1000,

        stock: 100,
        sales: 320,

        description: &#x27;Bi√®re brune irlandaise, go√ªt intense&#x27;,
        createdAt: new Date()
      },
      {
        id: &#x27;drink_5&#x27;,
        name: &#x27;Chablis 2020&#x27;,
        icon: &#x27;üç∑&#x27;,

        category: DrinkCategory.VIN_BLANC,
        format: DrinkFormat.CL_75,
        packagingType: PackagingType.BOUTEILLE,

        supplier: Supplier.AUTRES,
        depot: &#x27;D√©p√¥t Cocody&#x27;,
        commercialName: &#x27;Bakayoko Aminata&#x27;,
        commercialContact: &#x27;+225 05 00 00 00 02&#x27;,

        bulkUnit: BulkUnit.CAISSE,
        bulkQuantity: 2,
        unitsPerBulk: 6,
        totalBottles: 12,

        purchasePrice: 9500,
        sellingPrice: 12000,

        stock: 30,
        sales: 95,

        description: &#x27;Vin blanc sec de Bourgogne, notes min√©rales&#x27;,
        createdAt: new Date()
      }
    ];
  }

  /**
   * G√©n√®re des caves de test avec d√©tails enrichis
   * @returns Liste de caves simul√©es
   */
  private generateMockCaves(): Cave[] {
    // Chaque cave a maintenant des informations de temp√©rature et humidit√©
    return [
      {
        id: &#x27;cave_1&#x27;,
        name: &#x27;Cave Principale&#x27;,
        location: &#x27;B√¢timent A - Sous-sol&#x27;,
        capacity: 1000,                       // Capacit√© maximale : 1000 unit√©s
        currentStock: 650,                    // Stock actuel : 650 unit√©s
        description: &#x27;Cave principale de stockage&#x27;,
        temperature: &#x27;12-14¬∞C&#x27;,               // Temp√©rature contr√¥l√©e
        humidity: &#x27;70-75%&#x27;                    // Taux d&#x27;humidit√© optimal
      },
      {
        id: &#x27;cave_2&#x27;,
        name: &#x27;Cave Secondaire&#x27;,
        location: &#x27;B√¢timent B - RDC&#x27;,
        capacity: 500,
        currentStock: 320,
        description: &#x27;Cave secondaire pour rotation rapide&#x27;,
        temperature: &#x27;14-16¬∞C&#x27;,
        humidity: &#x27;65-70%&#x27;
      },
      {
        id: &#x27;cave_3&#x27;,
        name: &#x27;Cave de Vieillissement&#x27;,
        location: &#x27;B√¢timent A - Niveau -2&#x27;,
        capacity: 300,
        currentStock: 180,
        description: &#x27;Cave climatis√©e pour vins de garde&#x27;,
        temperature: &#x27;10-12¬∞C&#x27;,               // Plus fra√Æche pour les vins de garde
        humidity: &#x27;75-80%&#x27;                    // Humidit√© plus √©lev√©e
      }
    ];
  }

 /**
 * G√©n√®re des entr√©es de test ENRICHIES avec tous les d√©tails
 * Chaque entr√©e contient maintenant les informations compl√®tes de la boisson
 * @returns Liste d&#x27;entr√©es de stock simul√©es tri√©es par date d√©croissante
 */
private generateMockEntries(): StockEntry[] {
  const now &#x3D; new Date();

  // D√©claration explicite du tableau avec le bon type
  const entries: StockEntry[] &#x3D; [
    {
      // &#x3D;&#x3D;&#x3D; IDENTIFIANTS &#x3D;&#x3D;&#x3D;
      id: &#x27;entry_1&#x27;,
      date: new Date(now.getTime() - 2 * 24 * 60 * 60 * 1000), // Il y a 2 jours

      // &#x3D;&#x3D;&#x3D; INFORMATIONS BOISSON COMPL√àTES &#x3D;&#x3D;&#x3D;
      drinkId: &#x27;drink_1&#x27;,
      drinkName: &#x27;Heineken&#x27;,
      drinkIcon: &#x27;üç∫&#x27;,
      drinkCategory: DrinkCategory.BIERES,
      drinkFormat: DrinkFormat.CL_33,

      // &#x3D;&#x3D;&#x3D; CONDITIONNEMENT RE√áU &#x3D;&#x3D;&#x3D;
      bulkUnit: BulkUnit.CARTON,            // Type : Carton
      bulkQuantity: 5,                      // Nombre : 5 cartons
      unitsPerBulk: 12,                     // 12 bouteilles par carton
      quantity: 60,                         // Total : 5 √ó 12 &#x3D; 60 bouteilles

      // &#x3D;&#x3D;&#x3D; FOURNISSEUR ET DOCUMENTS &#x3D;&#x3D;&#x3D;
      supplier: Supplier.SOLIBRA,
      supplierInvoice: &#x27;INV-2024-001234&#x27;,   // Num√©ro de facture fournisseur
      deliveryNote: &#x27;BL-2024-005678&#x27;,       // Num√©ro de bon de livraison

      // &#x3D;&#x3D;&#x3D; COMMERCIAL &#x3D;&#x3D;&#x3D;
      commercialName: &#x27;Kouadio Jean&#x27;,
      commercialContact: &#x27;+225 07 00 00 00 01&#x27;,

      // &#x3D;&#x3D;&#x3D; TARIFICATION &#x3D;&#x3D;&#x3D;
      unitPrice: 650,                       // 650 FCFA par bouteille
      bulkPrice: 7800,                      // 650 √ó 12 &#x3D; 7800 FCFA par carton
      totalCost: 39000,                     // 7800 √ó 5 &#x3D; 39000 FCFA total

      // &#x3D;&#x3D;&#x3D; DESTINATION &#x3D;&#x3D;&#x3D;
      caveId: &#x27;cave_1&#x27;,                     // Stock√© dans Cave Principale

      // &#x3D;&#x3D;&#x3D; QUALIT√â ET CONFORMIT√â &#x3D;&#x3D;&#x3D;
      qualityCheck: &#x27;conforme&#x27; as &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;,  // ‚Üê TYPAGE EXPLICITE
      qualityNotes: &#x27;Livraison en bon √©tat, bouteilles bien emball√©es&#x27;,

      // &#x3D;&#x3D;&#x3D; TRA√áABILIT√â &#x3D;&#x3D;&#x3D;
      addedBy: &#x27;Jean Dupont&#x27;,               // Qui a enregistr√© l&#x27;entr√©e
      batchNumber: &#x27;LOT-2024-H-0123&#x27;,       // Num√©ro de lot fabricant
      expiryDate: new Date(2025, 11, 31),   // Date de p√©remption : 31/12/2025

      // &#x3D;&#x3D;&#x3D; NOTES &#x3D;&#x3D;&#x3D;
      notes: &#x27;R√©ception normale, stockage imm√©diat en cave fra√Æche&#x27;
    },
    {
      id: &#x27;entry_2&#x27;,
      date: new Date(now.getTime() - 5 * 24 * 60 * 60 * 1000), // Il y a 5 jours

      drinkId: &#x27;drink_2&#x27;,
      drinkName: &#x27;Bordeaux Rouge 2018&#x27;,
      drinkIcon: &#x27;üç∑&#x27;,
      drinkCategory: DrinkCategory.VIN_ROUGE,
      drinkFormat: DrinkFormat.CL_75,

      bulkUnit: BulkUnit.CAISSE,
      bulkQuantity: 3,
      unitsPerBulk: 6,
      quantity: 18,

      supplier: Supplier.AUTRES,
      supplierInvoice: &#x27;VINS-2024-456&#x27;,
      deliveryNote: &#x27;BL-VINS-789&#x27;,

      commercialName: &#x27;Bakayoko Aminata&#x27;,
      commercialContact: &#x27;+225 05 00 00 00 02&#x27;,

      unitPrice: 12000,
      bulkPrice: 72000,                     // 12000 √ó 6
      totalCost: 216000,                    // 72000 √ó 3

      caveId: &#x27;cave_3&#x27;,                     // Cave de vieillissement

      qualityCheck: &#x27;conforme&#x27; as &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;,  // ‚Üê TYPAGE EXPLICITE
      qualityNotes: &#x27;Mill√©sime exceptionnel, bouchons intacts&#x27;,

      addedBy: &#x27;Marie Martin&#x27;,
      batchNumber: &#x27;BDX-2018-RED-456&#x27;,
      expiryDate: new Date(2028, 11, 31),   // Vin de garde

      notes: &#x27;Stockage horizontal recommand√© pour pr√©server le bouchon&#x27;
    },
    {
      id: &#x27;entry_3&#x27;,
      date: new Date(now.getTime() - 10 * 24 * 60 * 60 * 1000), // Il y a 10 jours

      drinkId: &#x27;drink_3&#x27;,
      drinkName: &#x27;Champagne Mo√´t &amp; Chandon&#x27;,
      drinkIcon: &#x27;üçæ&#x27;,
      drinkCategory: DrinkCategory.CHAMPAGNE,
      drinkFormat: DrinkFormat.CL_75,

      bulkUnit: BulkUnit.CAISSE,
      bulkQuantity: 2,
      unitsPerBulk: 6,
      quantity: 12,

      supplier: Supplier.AUTRES,
      supplierInvoice: &#x27;CHAMP-2024-789&#x27;,
      deliveryNote: &#x27;BL-CHAMP-321&#x27;,

      commercialName: &#x27;Kon√© Moussa&#x27;,
      commercialContact: &#x27;+225 07 11 22 33 44&#x27;,

      unitPrice: 30000,
      bulkPrice: 180000,                    // 30000 √ó 6
      totalCost: 360000,                    // 180000 √ó 2

      caveId: &#x27;cave_3&#x27;,

      qualityCheck: &#x27;conforme&#x27; as &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;,  // ‚Üê TYPAGE EXPLICITE
      qualityNotes: &#x27;Temp√©rature de transport respect√©e, emballage premium&#x27;,

      addedBy: &#x27;Sophie Bernard&#x27;,
      batchNumber: &#x27;MC-NV-2024-001&#x27;,
      expiryDate: new Date(2027, 5, 30),

      notes: &#x27;Stockage √† temp√©rature contr√¥l√©e imp√©ratif (8-10¬∞C)&#x27;
    },
    {
      id: &#x27;entry_4&#x27;,
      date: new Date(now.getTime() - 15 * 24 * 60 * 60 * 1000), // Il y a 15 jours

      drinkId: &#x27;drink_4&#x27;,
      drinkName: &#x27;Guinness&#x27;,
      drinkIcon: &#x27;üç∫&#x27;,
      drinkCategory: DrinkCategory.BIERES,
      drinkFormat: DrinkFormat.CL_33,

      bulkUnit: BulkUnit.PACK,
      bulkQuantity: 4,
      unitsPerBulk: 24,
      quantity: 96,

      supplier: Supplier.BRASSIVOIRE,
      supplierInvoice: &#x27;BRA-2024-555&#x27;,
      deliveryNote: &#x27;BL-BRA-666&#x27;,

      commercialName: &#x27;Traor√© Sekou&#x27;,
      commercialContact: &#x27;+225 01 55 66 77 88&#x27;,

      unitPrice: 850,
      bulkPrice: 20400,                     // 850 √ó 24
      totalCost: 81600,                     // 20400 √ó 4

      caveId: &#x27;cave_2&#x27;,

      qualityCheck: &#x27;conforme&#x27; as &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;,  // ‚Üê TYPAGE EXPLICITE
      qualityNotes: &#x27;Canettes en parfait √©tat, date de production r√©cente&#x27;,

      addedBy: &#x27;Pierre Dubois&#x27;,
      batchNumber: &#x27;GUIN-2024-333&#x27;,
      expiryDate: new Date(2025, 8, 30),

      notes: &#x27;Promotion fournisseur - Prix r√©duit de 10%&#x27;
    },
    {
      id: &#x27;entry_5&#x27;,
      date: new Date(now.getTime() - 20 * 24 * 60 * 60 * 1000), // Il y a 20 jours

      drinkId: &#x27;drink_5&#x27;,
      drinkName: &#x27;Chablis 2020&#x27;,
      drinkIcon: &#x27;üç∑&#x27;,
      drinkCategory: DrinkCategory.VIN_BLANC,
      drinkFormat: DrinkFormat.CL_75,

      bulkUnit: BulkUnit.CAISSE,
      bulkQuantity: 2,
      unitsPerBulk: 6,
      quantity: 12,

      supplier: Supplier.AUTRES,
      supplierInvoice: &#x27;CHAB-2024-888&#x27;,
      deliveryNote: &#x27;BL-CHAB-999&#x27;,

      commercialName: &#x27;Bakayoko Aminata&#x27;,
      commercialContact: &#x27;+225 05 00 00 00 02&#x27;,

      unitPrice: 9500,
      bulkPrice: 57000,                     // 9500 √ó 6
      totalCost: 114000,                    // 57000 √ó 2

      caveId: &#x27;cave_3&#x27;,

      qualityCheck: &#x27;avec-reserve&#x27; as &#x27;conforme&#x27; | &#x27;non-conforme&#x27; | &#x27;avec-reserve&#x27;,  // ‚Üê TYPAGE EXPLICITE
      qualityNotes: &#x27;1 bouteille l√©g√®rement f√™l√©e, reste conforme&#x27;,

      addedBy: &#x27;Luc Moreau&#x27;,
      batchNumber: &#x27;CHAB-2020-112&#x27;,
      expiryDate: new Date(2026, 11, 31),

      notes: &#x27;Remise commerciale obtenue pour la bouteille d√©fectueuse&#x27;
    }
  ];

  // TRI par date d√©croissante (plus r√©cent en premier) et RETURN
  return entries.sort((a, b) &#x3D;&gt; new Date(b.date).getTime() - new Date(a.date).getTime());
}
  // ... (suite dans le prochain message)
  // ... (suite du fichier entries.component.ts)

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // CALCULS AUTOMATIQUES DU FORMULAIRE
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Calcule automatiquement le nombre total d&#x27;unit√©s
   * Exemple : 3 cartons √ó 12 bouteilles &#x3D; 36 bouteilles
   */
  calculateTotalUnits(): void {
    // Multiplie le nombre de conditionnements par les unit√©s par conditionnement
    this.entryForm.totalUnits &#x3D;
      (this.entryForm.bulkQuantity || 0) * (this.entryForm.unitsPerBulk || 0);

    // Recalcule ensuite le co√ªt total
    this.calculateTotalCost();

    console.log(&#x27;üî¢ Total unit√©s calcul√©:&#x27;, this.entryForm.totalUnits);
  }

  /**
   * Calcule automatiquement le prix par conditionnement
   * Exemple : 650 FCFA/bouteille √ó 12 bouteilles &#x3D; 7800 FCFA/carton
   */
  calculateBulkPrice(): void {
    // Prix unitaire √ó nombre d&#x27;unit√©s par conditionnement
    this.entryForm.bulkPrice &#x3D;
      (this.entryForm.unitPrice || 0) * (this.entryForm.unitsPerBulk || 0);

    // Recalcule le co√ªt total
    this.calculateTotalCost();

    console.log(&#x27;üí∞ Prix par conditionnement:&#x27;, this.entryForm.bulkPrice);
  }

  /**
   * Calcule le co√ªt total de l&#x27;entr√©e
   * Exemple : 7800 FCFA/carton √ó 3 cartons &#x3D; 23400 FCFA
   */
  calculateTotalCost(): void {
    // Prix par conditionnement √ó nombre de conditionnements
    this.entryForm.totalCost &#x3D;
      (this.entryForm.bulkPrice || 0) * (this.entryForm.bulkQuantity || 0);

    console.log(&#x27;üíµ Co√ªt total calcul√©:&#x27;, this.entryForm.totalCost, &#x27;FCFA&#x27;);
  }

  /**
   * G√®re le changement de boisson s√©lectionn√©e
   * Remplit automatiquement les champs depuis la boisson
   */
  onDrinkSelected(): void {
    // Trouve la boisson s√©lectionn√©e dans la liste
    const drink &#x3D; this.drinks.find(d &#x3D;&gt; d.id &#x3D;&#x3D;&#x3D; this.entryForm.drinkId);

    if (drink) {
      // Remplit automatiquement les informations de la boisson
      this.entryForm.bulkUnit &#x3D; drink.bulkUnit;
      this.entryForm.unitsPerBulk &#x3D; drink.unitsPerBulk;
      this.entryForm.unitPrice &#x3D; drink.purchasePrice;
      this.entryForm.supplier &#x3D; drink.supplier;

      // Recalcule tout
      this.calculateBulkPrice();
      this.calculateTotalUnits();

      // Charge les suggestions d&#x27;accords mets-vins pour cette boisson
      this.loadWinePairingSuggestions(drink);

      console.log(&#x27;‚úÖ Boisson s√©lectionn√©e:&#x27;, drink.name);
    }
  }

  /**
   * Charge les suggestions d&#x27;accords mets-vins pour une boisson
   * Int√©gration avec le composant wine-pairing
   * @param drink Boisson s√©lectionn√©e
   */
  loadWinePairingSuggestions(drink: Drink): void {
    // R√©initialise les suggestions
    this.winePairingSuggestions &#x3D; [];

    // Suggestions selon la cat√©gorie de boisson
    switch (drink.category) {
      case DrinkCategory.VIN_ROUGE:
        // Pour les vins rouges : viandes, fromages
        this.winePairingSuggestions &#x3D; [
          {
            dish: &#x27;Steak grill√©&#x27;,
            dishIcon: &#x27;ü•©&#x27;,
            description: &#x27;Les tanins du vin rouge s\&#x27;accordent parfaitement avec la richesse de la viande rouge&#x27;,
            temperature: &#x27;16-18¬∞C&#x27;
          },
          {
            dish: &#x27;Fromages affin√©s&#x27;,
            dishIcon: &#x27;üßÄ&#x27;,
            description: &#x27;Un accord classique entre la puissance du vin et l\&#x27;intensit√© du fromage&#x27;,
            temperature: &#x27;16-18¬∞C&#x27;
          }
        ];
        break;

      case DrinkCategory.VIN_BLANC:
        // Pour les vins blancs : poissons, fruits de mer
        this.winePairingSuggestions &#x3D; [
          {
            dish: &#x27;Poisson grill√©&#x27;,
            dishIcon: &#x27;üêü&#x27;,
            description: &#x27;La fra√Æcheur du vin blanc compl√®te d√©licatement le go√ªt du poisson&#x27;,
            temperature: &#x27;10-12¬∞C&#x27;
          },
          {
            dish: &#x27;Fruits de mer&#x27;,
            dishIcon: &#x27;ü¶û&#x27;,
            description: &#x27;Un mariage parfait entre la min√©ralit√© du vin et l\&#x27;iode des fruits de mer&#x27;,
            temperature: &#x27;8-10¬∞C&#x27;
          }
        ];
        break;

      case DrinkCategory.CHAMPAGNE:
        // Pour le champagne : ap√©ritifs, desserts
        this.winePairingSuggestions &#x3D; [
          {
            dish: &#x27;Ap√©ritif&#x27;,
            dishIcon: &#x27;ü•Ç&#x27;,
            description: &#x27;Les bulles fines du champagne sont parfaites pour l\&#x27;ap√©ritif&#x27;,
            temperature: &#x27;6-8¬∞C&#x27;
          },
          {
            dish: &#x27;Desserts l√©gers&#x27;,
            dishIcon: &#x27;üç∞&#x27;,
            description: &#x27;Un champagne demi-sec accompagne merveilleusement les desserts&#x27;,
            temperature: &#x27;6-8¬∞C&#x27;
          }
        ];
        break;

      case DrinkCategory.BIERES:
        // Pour les bi√®res : snacks, plats √©pic√©s
        this.winePairingSuggestions &#x3D; [
          {
            dish: &#x27;Grillades&#x27;,
            dishIcon: &#x27;üçñ&#x27;,
            description: &#x27;La fra√Æcheur de la bi√®re rafra√Æchit le palais entre chaque bouch√©e&#x27;,
            temperature: &#x27;4-6¬∞C&#x27;
          },
          {
            dish: &#x27;Plats √©pic√©s&#x27;,
            dishIcon: &#x27;üå∂Ô∏è&#x27;,
            description: &#x27;La bi√®re att√©nue le piquant des √©pices&#x27;,
            temperature: &#x27;4-6¬∞C&#x27;
          }
        ];
        break;

      default:
        // Pas de suggestion sp√©cifique
        this.winePairingSuggestions &#x3D; [];
    }

    console.log(&#x27;üçΩÔ∏è Suggestions d\&#x27;accords charg√©es:&#x27;, this.winePairingSuggestions.length);
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // FILTRAGE ET RECHERCHE
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Applique tous les filtres actifs sur les entr√©es
   * Combine : cave, cat√©gorie, fournisseur, p√©riode et recherche textuelle
   */
  applyFilters(): void {
    // On part de toutes les entr√©es
    let result &#x3D; [...this.entries];

    // FILTRE 1 : Par cave s√©lectionn√©e
    if (this.selectedCaveFilter) {
      result &#x3D; result.filter(entry &#x3D;&gt; entry.caveId &#x3D;&#x3D;&#x3D; this.selectedCaveFilter);
      console.log(&#x60;üìç Filtre cave appliqu√©: ${result.length} r√©sultats&#x60;);
    }

    // FILTRE 2 : Par cat√©gorie de boisson
    if (this.selectedCategoryFilter) {
      result &#x3D; result.filter(entry &#x3D;&gt; entry.drinkCategory &#x3D;&#x3D;&#x3D; this.selectedCategoryFilter);
      console.log(&#x60;üè∑Ô∏è Filtre cat√©gorie appliqu√©: ${result.length} r√©sultats&#x60;);
    }

    // FILTRE 3 : Par fournisseur
    if (this.selectedSupplierFilter) {
      result &#x3D; result.filter(entry &#x3D;&gt; entry.supplier &#x3D;&#x3D;&#x3D; this.selectedSupplierFilter);
      console.log(&#x60;üöö Filtre fournisseur appliqu√©: ${result.length} r√©sultats&#x60;);
    }

    // FILTRE 4 : Par p√©riode (nombre de jours)
    if (this.periodFilter &gt; 0) {
      const cutoffDate &#x3D; new Date();
      cutoffDate.setDate(cutoffDate.getDate() - this.periodFilter);
      result &#x3D; result.filter(entry &#x3D;&gt; new Date(entry.date) &gt;&#x3D; cutoffDate);
      console.log(&#x60;üìÖ Filtre p√©riode appliqu√© (${this.periodFilter} jours): ${result.length} r√©sultats&#x60;);
    }

    // FILTRE 5 : Par terme de recherche (nom, notes, commercial, etc.)
    if (this.searchTerm.trim()) {
      const term &#x3D; this.searchTerm.toLowerCase();
      result &#x3D; result.filter(entry &#x3D;&gt;
        // Recherche dans le nom de la boisson
        entry.drinkName.toLowerCase().includes(term) ||
        // Recherche dans le fournisseur
        entry.supplier.toLowerCase().includes(term) ||
        // Recherche dans les notes
        entry.notes?.toLowerCase().includes(term) ||
        // Recherche dans le nom du commercial
        entry.commercialName.toLowerCase().includes(term) ||
        // Recherche dans la personne qui a ajout√©
        entry.addedBy.toLowerCase().includes(term) ||
        // Recherche dans le num√©ro de facture
        entry.supplierInvoice?.toLowerCase().includes(term) ||
        // Recherche dans le num√©ro de bon de livraison
        entry.deliveryNote?.toLowerCase().includes(term)
      );
      console.log(&#x60;üîç Recherche &quot;${term}&quot; appliqu√©e: ${result.length} r√©sultats&#x60;);
    }

    // Affecte les r√©sultats filtr√©s
    this.filteredEntries &#x3D; result;

    console.log(&#x60;‚úÖ Filtrage termin√©: ${result.length} entr√©e(s) sur ${this.entries.length}&#x60;);
  }

  /**
   * G√®re le changement du filtre cave
   */
  onCaveFilterChange(): void {
    console.log(&#x27;üîÑ Changement filtre cave:&#x27;, this.selectedCaveFilter);
    this.applyFilters();
  }

  /**
   * G√®re le changement du filtre cat√©gorie
   */
  onCategoryFilterChange(): void {
    console.log(&#x27;üîÑ Changement filtre cat√©gorie:&#x27;, this.selectedCategoryFilter);
    this.applyFilters();
  }

  /**
   * G√®re le changement du filtre fournisseur
   */
  onSupplierFilterChange(): void {
    console.log(&#x27;üîÑ Changement filtre fournisseur:&#x27;, this.selectedSupplierFilter);
    this.applyFilters();
  }

  /**
   * G√®re le changement de la p√©riode de filtre
   */
  onPeriodFilterChange(): void {
    console.log(&#x27;üîÑ Changement p√©riode:&#x27;, this.periodFilter, &#x27;jours&#x27;);
    this.applyFilters();
  }

  /**
   * G√®re le changement du terme de recherche
   */
  onSearchChange(): void {
    this.applyFilters();
  }

  /**
   * R√©initialise tous les filtres √† leurs valeurs par d√©faut
   */
  resetFilters(): void {
    this.selectedCaveFilter &#x3D; null;
    this.selectedCategoryFilter &#x3D; null;
    this.selectedSupplierFilter &#x3D; null;
    this.periodFilter &#x3D; 30;
    this.searchTerm &#x3D; &#x27;&#x27;;
    this.filteredEntries &#x3D; [...this.entries];

    console.log(&#x27;üîÑ Tous les filtres r√©initialis√©s&#x27;);
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // CALCUL DES STATISTIQUES ENRICHIES
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Calcule toutes les statistiques des entr√©es
   * Version enrichie avec moyennes, taux de conformit√©, etc.
   */
  calculateStats(): void {
    // 1. Nombre total d&#x27;entr√©es
    this.stats.totalEntries &#x3D; this.entries.length;

    // 2. Quantit√© totale d&#x27;unit√©s re√ßues
    this.stats.totalQuantity &#x3D; this.entries.reduce((sum, entry) &#x3D;&gt; sum + entry.quantity, 0);

    // 3. Co√ªt total de toutes les entr√©es
    this.stats.totalCost &#x3D; this.entries.reduce((sum, entry) &#x3D;&gt; sum + entry.totalCost, 0);

    // 4. Prix unitaire moyen
    if (this.entries.length &gt; 0) {
      const totalUnitPrices &#x3D; this.entries.reduce((sum, entry) &#x3D;&gt; sum + entry.unitPrice, 0);
      this.stats.averageUnitPrice &#x3D; Math.round(totalUnitPrices / this.entries.length);
    }

    // 5. Nombre total de conditionnements (cartons, caisses, etc.)
    this.stats.totalBulkUnits &#x3D; this.entries.reduce((sum, entry) &#x3D;&gt; sum + entry.bulkQuantity, 0);

    // 6. Entr√©es des 7 derniers jours
    const sevenDaysAgo &#x3D; new Date();
    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
    this.stats.recentEntries &#x3D; this.entries.filter(
      entry &#x3D;&gt; new Date(entry.date) &gt;&#x3D; sevenDaysAgo
    ).length;

    // 7. Taux de conformit√© (%)
    const conformEntries &#x3D; this.entries.filter(e &#x3D;&gt; e.qualityCheck &#x3D;&#x3D;&#x3D; &#x27;conforme&#x27;).length;
    this.stats.conformityRate &#x3D; this.entries.length &gt; 0
      ? Math.round((conformEntries / this.entries.length) * 100)
      : 0;

    // 8. Fournisseur principal (celui qui a le plus d&#x27;entr√©es)
    const supplierCounts: { [key: string]: number } &#x3D; {};
    this.entries.forEach(entry &#x3D;&gt; {
      const supplier &#x3D; entry.supplier;
      supplierCounts[supplier] &#x3D; (supplierCounts[supplier] || 0) + 1;
    });

    let maxCount &#x3D; 0;
    let topSupplier &#x3D; &#x27;&#x27;;
    Object.entries(supplierCounts).forEach(([supplier, count]) &#x3D;&gt; {
      if (count &gt; maxCount) {
        maxCount &#x3D; count;
        topSupplier &#x3D; supplier;
      }
    });
    this.stats.topSupplier &#x3D; topSupplier;

    // 9. Cat√©gorie la plus re√ßue
    const categoryCounts: { [key: string]: number } &#x3D; {};
    this.entries.forEach(entry &#x3D;&gt; {
      const category &#x3D; entry.drinkCategory;
      categoryCounts[category] &#x3D; (categoryCounts[category] || 0) + 1;
    });

    maxCount &#x3D; 0;
    let topCategory &#x3D; &#x27;&#x27;;
    Object.entries(categoryCounts).forEach(([category, count]) &#x3D;&gt; {
      if (count &gt; maxCount) {
        maxCount &#x3D; count;
        topCategory &#x3D; category;
      }
    });
    this.stats.topCategory &#x3D; topCategory;

    console.log(&#x27;üìä Statistiques calcul√©es:&#x27;, this.stats);
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // MODAL - AJOUT D&#x27;ENTR√âE
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Ouvre le modal d&#x27;ajout d&#x27;une nouvelle entr√©e
   */
  openAddModal(): void {
    // R√©initialise le formulaire avec des valeurs vides
    this.entryForm &#x3D; this.getEmptyForm();

    // R√©initialise les suggestions d&#x27;accords
    this.winePairingSuggestions &#x3D; [];

    // Ouvre le modal
    this.isAddModalOpen &#x3D; true;

    console.log(&#x27;‚ûï Modal d\&#x27;ajout ouvert&#x27;);
  }

  /**
   * Ferme le modal d&#x27;ajout et r√©initialise le formulaire
   */
  closeAddModal(): void {
    // Ferme le modal
    this.isAddModalOpen &#x3D; false;

    // R√©initialise le formulaire
    this.entryForm &#x3D; this.getEmptyForm();

    // R√©initialise les suggestions
    this.winePairingSuggestions &#x3D; [];

    console.log(&#x27;‚úÖ Modal d\&#x27;ajout ferm√©&#x27;);
  }

  /**
   * Sauvegarde une nouvelle entr√©e de stock
   * Valide les donn√©es, cr√©e l&#x27;entr√©e enrichie et met √† jour les stats
   */
  saveEntry(): void {
    // VALIDATION : V√©rifie que tous les champs obligatoires sont remplis
    if (!this.validateForm()) {
      alert(&#x27;‚ö†Ô∏è Veuillez remplir tous les champs obligatoires (boisson, quantit√©, prix, cave)&#x27;);
      return;
    }

    // R√âCUP√âRATION : Trouve la boisson s√©lectionn√©e dans la liste
    const drink &#x3D; this.drinks.find(d &#x3D;&gt; d.id &#x3D;&#x3D;&#x3D; this.entryForm.drinkId);
    if (!drink) {
      alert(&#x27;‚ùå Boisson non trouv√©e. Veuillez s√©lectionner une boisson valide.&#x27;);
      return;
    }

    // VALIDATION QUANTIT√â : V√©rifie que la quantit√© est positive
    if (this.entryForm.bulkQuantity &lt;&#x3D; 0 || this.entryForm.totalUnits &lt;&#x3D; 0) {
      alert(&#x27;‚ùå La quantit√© doit √™tre sup√©rieure √† z√©ro&#x27;);
      return;
    }

    // CR√âATION : Construit la nouvelle entr√©e avec TOUS les d√©tails
    const newEntry: StockEntry &#x3D; {
      // G√©n√®re un ID unique
      id: this.generateId(),

      // Date actuelle
      date: new Date(),

      // Informations compl√®tes de la boisson
      drinkId: this.entryForm.drinkId,
      drinkName: drink.name,
      drinkIcon: drink.icon,
      drinkCategory: drink.category,
      drinkFormat: drink.format,

      // Conditionnement re√ßu
      bulkUnit: this.entryForm.bulkUnit,
      bulkQuantity: this.entryForm.bulkQuantity,
      unitsPerBulk: this.entryForm.unitsPerBulk,
      quantity: this.entryForm.totalUnits,

      // Fournisseur et documents
      supplier: this.entryForm.supplier,
      supplierInvoice: this.entryForm.supplierInvoice,
      deliveryNote: this.entryForm.deliveryNote,

      // Commercial
      commercialName: drink.commercialName,
      commercialContact: drink.commercialContact,

      // Tarification
      unitPrice: this.entryForm.unitPrice,
      bulkPrice: this.entryForm.bulkPrice,
      totalCost: this.entryForm.totalCost,

      // Destination
      caveId: this.entryForm.caveId,

      // Qualit√©
      qualityCheck: this.entryForm.qualityCheck,
      qualityNotes: this.entryForm.qualityNotes,

      // Tra√ßabilit√©
      addedBy: &#x27;Utilisateur actuel&#x27;, // TODO: Remplacer par l&#x27;utilisateur connect√©
      batchNumber: this.entryForm.batchNumber,
      expiryDate: this.entryForm.expiryDate ? new Date(this.entryForm.expiryDate) : undefined,

      // Notes
      notes: this.entryForm.notes
    };

    // AJOUT : Ins√®re la nouvelle entr√©e en premi√®re position (plus r√©cente en haut)
    this.entries.unshift(newEntry);

    // MISE √Ä JOUR : Applique les filtres pour rafra√Æchir l&#x27;affichage
    this.applyFilters();

    // RECALCUL : Met √† jour toutes les statistiques
    this.calculateStats();

    // TODO: APPEL API pour sauvegarder sur le serveur
    // this.entryService.createEntry(newEntry).subscribe(...)

    console.log(&#x27;‚úÖ Entr√©e ajout√©e avec succ√®s:&#x27;, newEntry);

    // NOTIFICATION : Informe l&#x27;utilisateur
    alert(&#x60;‚úÖ Entr√©e enregistr√©e avec succ√®s !\n\n&#x60; +
          &#x60;üì¶ Boisson: ${drink.name}\n&#x60; +
          &#x60;üî¢ Quantit√©: ${newEntry.quantity} unit√©s\n&#x60; +
          &#x60;üí∞ Co√ªt total: ${this.formatNumber(newEntry.totalCost)} FCFA&#x60;);

    // FERMETURE : Ferme le modal
    this.closeAddModal();
  }

  /**
   * Valide le formulaire d&#x27;entr√©e
   * V√©rifie que tous les champs obligatoires sont remplis
   * @returns true si le formulaire est valide
   */
  private validateForm(): boolean {
    return !!(
      // Boisson s√©lectionn√©e
      this.entryForm.drinkId &amp;&amp;

      // Quantit√©s valides
      this.entryForm.bulkQuantity &gt; 0 &amp;&amp;
      this.entryForm.unitsPerBulk &gt; 0 &amp;&amp;
      this.entryForm.totalUnits &gt; 0 &amp;&amp;

      // Prix valides
      this.entryForm.unitPrice &gt; 0 &amp;&amp;
      this.entryForm.bulkPrice &gt; 0 &amp;&amp;
      this.entryForm.totalCost &gt; 0 &amp;&amp;

      // Cave s√©lectionn√©e
      this.entryForm.caveId &amp;&amp;

      // Contr√¥le qualit√© effectu√©
      this.entryForm.qualityCheck
    );
  }

  /**
   * Retourne un formulaire vide initialis√© avec valeurs par d√©faut
   * @returns Formulaire avec valeurs par d√©faut
   */
  private getEmptyForm(): StockEntryForm {
    return {
      drinkId: &#x27;&#x27;,
      bulkUnit: BulkUnit.CARTON,
      bulkQuantity: 1,
      unitsPerBulk: 12,
      totalUnits: 12,
      unitPrice: 0,
      bulkPrice: 0,
      totalCost: 0,
      supplier: Supplier.SOLIBRA,
      supplierInvoice: &#x27;&#x27;,
      deliveryNote: &#x27;&#x27;,
      caveId: &#x27;&#x27;,
      qualityCheck: &#x27;conforme&#x27;,
      qualityNotes: &#x27;&#x27;,
      batchNumber: &#x27;&#x27;,
      expiryDate: &#x27;&#x27;,
      notes: &#x27;&#x27;
    };
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // MODAL - D√âTAILS D&#x27;ENTR√âE
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Affiche les d√©tails complets d&#x27;une entr√©e dans un modal
   * @param entry Entr√©e √† afficher
   */
  viewEntryDetails(entry: StockEntry): void {
    // S√©lectionne l&#x27;entr√©e
    this.selectedEntry &#x3D; entry;

    // Charge les informations de la boisson pour afficher les accords
    const drink &#x3D; this.drinks.find(d &#x3D;&gt; d.id &#x3D;&#x3D;&#x3D; entry.drinkId);
    if (drink) {
      this.loadWinePairingSuggestions(drink);
    }

    // Ouvre le modal de d√©tails
    this.isDetailModalOpen &#x3D; true;

    console.log(&#x27;üëÅÔ∏è D√©tails de l\&#x27;entr√©e affich√©s:&#x27;, entry);
  }

  /**
   * Ferme le modal de d√©tails
   */
  closeDetailModal(): void {
    this.isDetailModalOpen &#x3D; false;
    this.selectedEntry &#x3D; null;
    this.winePairingSuggestions &#x3D; [];

    console.log(&#x27;‚úÖ Modal de d√©tails ferm√©&#x27;);
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // SUPPRESSION
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * Supprime une entr√©e apr√®s confirmation de l&#x27;utilisateur
   * Met √† jour la liste, les filtres et les statistiques
   * @param entry Entr√©e √† supprimer
   */
  deleteEntry(entry: StockEntry): void {
    // Message de confirmation d√©taill√© avec toutes les infos
    const confirmMessage &#x3D;
      &#x60;‚ö†Ô∏è √ätes-vous s√ªr de vouloir supprimer cette entr√©e ?\n\n&#x60; +
      &#x60;üì¶ Produit: ${entry.drinkIcon} ${entry.drinkName}\n&#x60; +
      &#x60;üìè Format: ${entry.drinkFormat}\n&#x60; +
      &#x60;üî¢ Quantit√©: ${entry.quantity} unit√©s (${entry.bulkQuantity} √ó ${entry.bulkUnit})\n&#x60; +
      &#x60;üí∞ Co√ªt: ${this.formatNumber(entry.totalCost)} FCFA\n&#x60; +
      &#x60;üìÖ Date: ${this.formatDate(entry.date)}\n&#x60; +
      &#x60;üöö Fournisseur: ${entry.supplier}\n\n&#x60; +
      &#x60;Cette action est irr√©versible !&#x60;;

    // Demande confirmation
    if (confirm(confirmMessage)) {
      // Trouve l&#x27;index de l&#x27;entr√©e dans le tableau
      const index &#x3D; this.entries.findIndex(e &#x3D;&gt; e.id &#x3D;&#x3D;&#x3D; entry.id);

      if (index !&#x3D;&#x3D; -1) {
        // Supprime l&#x27;entr√©e du tableau
        this.entries.splice(index, 1);

        // Met √† jour les filtres pour rafra√Æchir l&#x27;affichage
        this.applyFilters();

        // Recalcule les statistiques
        this.calculateStats();

        // TODO: APPEL API DELETE pour supprimer du serveur
        // this.entryService.deleteEntry(entry.id).subscribe(...)

        console.log(&#x27;üóëÔ∏è Entr√©e supprim√©e:&#x27;, entry.id);

        // Notification de succ√®s
        alert(&#x27;‚úÖ Entr√©e supprim√©e avec succ√®s !&#x27;);
      }
    } else {
      console.log(&#x27;‚ùå Suppression annul√©e par l\&#x27;utilisateur&#x27;);
    }
  }

  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;
  // M√âTHODES UTILITAIRES
  // &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;

  /**
   * G√©n√®re un ID unique pour une entr√©e
   * Format: entry_timestamp_random
   * @returns ID unique g√©n√©r√©
   */
  private generateId(): string {
    const timestamp &#x3D; Date.now();
    const random &#x3D; Math.random().toString(36).substr(2, 9);
    return &#x60;entry_${timestamp}_${random}&#x60;;
  }

  /**
   * Formate un nombre avec des espaces comme s√©parateurs de milliers
   * Exemple: 1000000 ‚Üí &quot;1 000 000&quot;
   * @param num Nombre √† formater
   * @returns Nombre format√©
   */
  formatNumber(num: number): string {
    return num.toString().replace(/\B(?&#x3D;(\d{3})+(?!\d))/g, &#x27; &#x27;);
  }

  /**
   * Formate une date au format fran√ßais complet
   * Exemple: &quot;15 janvier 2024 √† 14:30&quot;
   * @param date Date √† formater
   * @returns Date format√©e en fran√ßais
   */
  formatDate(date: Date): string {
    const d &#x3D; new Date(date);
    const options: Intl.DateTimeFormatOptions &#x3D; {
      year: &#x27;numeric&#x27;,
      month: &#x27;long&#x27;,
      day: &#x27;numeric&#x27;,
      hour: &#x27;2-digit&#x27;,
      minute: &#x27;2-digit&#x27;
    };
    return d.toLocaleDateString(&#x27;fr-FR&#x27;, options);
  }

  /**
   * Retourne le nom d&#x27;une cave √† partir de son ID
   * @param caveId ID de la cave
   * @returns Nom de la cave ou &quot;Cave inconnue&quot;
   */
  getCaveName(caveId: string): string {
    const cave &#x3D; this.caves.find(c &#x3D;&gt; c.id &#x3D;&#x3D;&#x3D; caveId);
    return cave ? cave.name : &#x27;Cave inconnue&#x27;;
  }

  /**
   * Retourne le nom d&#x27;une boisson √† partir de son ID
   * @param drinkId ID de la boisson
   * @returns Nom de la boisson ou &quot;Boisson inconnue&quot;
   */
  getDrinkName(drinkId: string): string {
    const drink &#x3D; this.drinks.find(d &#x3D;&gt; d.id &#x3D;&#x3D;&#x3D; drinkId);
    return drink ? drink.name : &#x27;Boisson inconnue&#x27;;
  }

  /**
   * Retourne une date relative lisible
   * Exemples: &quot;Aujourd&#x27;hui&quot;, &quot;Hier&quot;, &quot;Il y a 3 jours&quot;, &quot;Il y a 2 semaines&quot;
   * @param date Date √† convertir
   * @returns Texte repr√©sentant la date relative
   */
  getRelativeDate(date: Date): string {
    const now &#x3D; new Date();
    const diff &#x3D; now.getTime() - new Date(date).getTime();
    const days &#x3D; Math.floor(diff / (1000 * 60 * 60 * 24));

    if (days &#x3D;&#x3D;&#x3D; 0) return &quot;Aujourd&#x27;hui&quot;;
    if (days &#x3D;&#x3D;&#x3D; 1) return &quot;Hier&quot;;
    if (days &lt; 7) return &#x60;Il y a ${days} jours&#x60;;
    if (days &lt; 30) {
      const weeks &#x3D; Math.floor(days / 7);
      return &#x60;Il y a ${weeks} semaine${weeks &gt; 1 ? &#x27;s&#x27; : &#x27;&#x27;}&#x60;;
    }
    const months &#x3D; Math.floor(days / 30);
    return &#x60;Il y a ${months} mois&#x60;;
  }

  /**
   * Retourne le libell√© du contr√¥le qualit√©
   * @param check Type de contr√¥le
   * @returns Libell√© format√©
   */
  getQualityCheckLabel(check: string): string {
    const labels: {[key: string]: string} &#x3D; {
      &#x27;conforme&#x27;: &#x27;‚úÖ Conforme&#x27;,
      &#x27;non-conforme&#x27;: &#x27;‚ùå Non conforme&#x27;,
      &#x27;avec-reserve&#x27;: &#x27;‚ö†Ô∏è Avec r√©serve&#x27;
    };
    return labels[check] || check;
  }

  /**
   * Retourne la classe CSS pour le contr√¥le qualit√©
   * @param check Type de contr√¥le
   * @returns Classe CSS
   */
  getQualityCheckClass(check: string): string {
    const classes: {[key: string]: string} &#x3D; {
      &#x27;conforme&#x27;: &#x27;quality-conform&#x27;,
      &#x27;non-conforme&#x27;: &#x27;quality-non-conform&#x27;,
      &#x27;avec-reserve&#x27;: &#x27;quality-reserve&#x27;
    };
    return classes[check] || &#x27;&#x27;;
  }

  /**
   * Exporte les entr√©es filtr√©es en fichier CSV
   * T√©l√©charge automatiquement le fichier
   */
  exportToCSV(): void {
    // V√©rifie qu&#x27;il y a des entr√©es √† exporter
    if (this.filteredEntries.length &#x3D;&#x3D;&#x3D; 0) {
      alert(&#x27;‚ùå Aucune entr√©e √† exporter&#x27;);
      return;
    }

    // En-t√™tes du CSV avec TOUS les champs
    const headers &#x3D; [
      &#x27;Date&#x27;,
      &#x27;Boisson&#x27;,
      &#x27;Cat√©gorie&#x27;,
      &#x27;Format&#x27;,
      &#x27;Conditionnement&#x27;,
      &#x27;Quantit√© Conditionnements&#x27;,
      &#x27;Unit√©s par Conditionnement&#x27;,
      &#x27;Quantit√© Totale&#x27;,
      &#x27;Prix Unitaire (FCFA)&#x27;,
      &#x27;Prix Conditionnement (FCFA)&#x27;,
      &#x27;Co√ªt Total (FCFA)&#x27;,
      &#x27;Fournisseur&#x27;,
      &#x27;Commercial&#x27;,
      &#x27;Contact Commercial&#x27;,
      &#x27;Cave&#x27;,
      &#x27;Facture Fournisseur&#x27;,
      &#x27;Bon de Livraison&#x27;,
      &#x27;Contr√¥le Qualit√©&#x27;,
      &#x27;Notes Qualit√©&#x27;,
      &#x27;Num√©ro de Lot&#x27;,
      &#x27;Date de P√©remption&#x27;,
      &#x27;Ajout√© par&#x27;,
      &#x27;Notes&#x27;
    ];
// Conversion des donn√©es en lignes CSV
    const rows &#x3D; this.filteredEntries.map(entry &#x3D;&gt; [
      this.formatDate(entry.date),
      entry.drinkName,
      entry.drinkCategory,
      entry.drinkFormat,
      entry.bulkUnit,
      entry.bulkQuantity.toString(),
      entry.unitsPerBulk.toString(),
      entry.quantity.toString(),
      entry.unitPrice.toString(),
      entry.bulkPrice.toString(),
      entry.totalCost.toString(),
      entry.supplier,
      entry.commercialName,
      entry.commercialContact,
      this.getCaveName(entry.caveId),
      entry.supplierInvoice || &#x27;N/A&#x27;,
      entry.deliveryNote || &#x27;N/A&#x27;,
      this.getQualityCheckLabel(entry.qualityCheck),
      (entry.qualityNotes || &#x27;Aucune note&#x27;).replace(/,/g, &#x27;;&#x27;), // Remplace les virgules
      entry.batchNumber || &#x27;N/A&#x27;,
      entry.expiryDate ? this.formatDate(entry.expiryDate) : &#x27;N/A&#x27;,
      entry.addedBy,
      (entry.notes || &#x27;Aucune note&#x27;).replace(/,/g, &#x27;;&#x27;) // Remplace les virgules
    ]);

    // Cr√©ation du contenu CSV avec encodage UTF-8
    const csvContent &#x3D; [
      headers.join(&#x27;,&#x27;),
      ...rows.map(row &#x3D;&gt; row.map(cell &#x3D;&gt; &#x60;&quot;${cell}&quot;&#x60;).join(&#x27;,&#x27;))
    ].join(&#x27;\n&#x27;);

    // Cr√©ation du blob avec BOM UTF-8 pour Excel
    const blob &#x3D; new Blob([&#x27;\ufeff&#x27; + csvContent], { type: &#x27;text/csv;charset&#x3D;utf-8;&#x27; });

    // Cr√©ation du lien de t√©l√©chargement
    const link &#x3D; document.createElement(&#x27;a&#x27;);
    const url &#x3D; URL.createObjectURL(blob);
    const fileName &#x3D; &#x60;entrees_stock_${new Date().toISOString().split(&#x27;T&#x27;)[0]}.csv&#x60;;

    link.setAttribute(&#x27;href&#x27;, url);
    link.setAttribute(&#x27;download&#x27;, fileName);
    link.style.visibility &#x3D; &#x27;hidden&#x27;;

    // Ajout, clic et suppression du lien
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    // Lib√©ration de la m√©moire
    URL.revokeObjectURL(url);

    console.log(&#x60;üìä Export CSV effectu√©: ${fileName} (${this.filteredEntries.length} entr√©es)&#x60;);

    alert(&#x60;‚úÖ Export r√©ussi !\n\n&#x60; +
          &#x60;üìÑ Fichier: ${fileName}\n&#x60; +
          &#x60;üìä ${this.filteredEntries.length} entr√©e(s) export√©e(s)\n&#x60; +
          &#x60;üíæ Le fichier a √©t√© t√©l√©charg√©&#x60;);
  }

  /**
   * Lance l&#x27;impression de la page actuelle
   * Utilise la fonction d&#x27;impression du navigateur
   */
  printEntries(): void {
    console.log(&#x27;üñ®Ô∏è Impression des entr√©es lanc√©e&#x27;);
    window.print();
  }

  /**
   * Calcule le taux de marge pour une entr√©e
   * Compare le prix d&#x27;achat et le prix de vente
   * @param entry Entr√©e de stock
   * @returns Taux de marge en pourcentage
   */
  calculateMarginRate(entry: StockEntry): number {
    // Trouve la boisson correspondante
    const drink &#x3D; this.drinks.find(d &#x3D;&gt; d.id &#x3D;&#x3D;&#x3D; entry.drinkId);

    if (drink &amp;&amp; entry.unitPrice &gt; 0) {
      // Calcule la marge : (Prix vente - Prix achat) / Prix achat √ó 100
      const margin &#x3D; drink.sellingPrice - entry.unitPrice;
      const marginRate &#x3D; (margin / entry.unitPrice) * 100;
      return Math.round(marginRate * 100) / 100; // Arrondi √† 2 d√©cimales
    }

    return 0;
  }

  /**
   * Retourne la classe CSS selon la cat√©gorie de boisson
   * @param category Cat√©gorie de la boisson
   * @returns Classe CSS
   */
  getCategoryClass(category: DrinkCategory): string {
    const classMap: { [key in DrinkCategory]: string } &#x3D; {
      [DrinkCategory.BIERES]: &#x27;category-beer&#x27;,
      [DrinkCategory.SUCRERIES]: &#x27;category-sweet&#x27;,
      [DrinkCategory.CHAMPAGNE]: &#x27;category-champagne&#x27;,
      [DrinkCategory.VIN_BLANC]: &#x27;category-white-wine&#x27;,
      [DrinkCategory.VIN_ROUGE]: &#x27;category-red-wine&#x27;,
      [DrinkCategory.VIN_ROSE]: &#x27;category-rose-wine&#x27;,
      [DrinkCategory.VIN_MOUSSEUX]: &#x27;category-sparkling&#x27;,
      [DrinkCategory.LIQUEURS]: &#x27;category-liquor&#x27;,
      [DrinkCategory.BOISSONS_ENERGISANTES]: &#x27;category-energy&#x27;,
      [DrinkCategory.BOISSONS_LOCALES]: &#x27;category-local&#x27;
    };
    return classMap[category] || &#x27;&#x27;;
  }

  /**
   * Retourne l&#x27;ic√¥ne selon le type de conditionnement
   * @param bulkUnit Type de conditionnement
   * @returns Emoji repr√©sentatif
   */
  getBulkUnitIcon(bulkUnit: BulkUnit): string {
    const iconMap: { [key in BulkUnit]: string } &#x3D; {
      [BulkUnit.CARTON]: &#x27;üì¶&#x27;,
      [BulkUnit.CASIER]: &#x27;üß∞&#x27;,
      [BulkUnit.PACK]: &#x27;üì¶&#x27;,
      [BulkUnit.CAISSE]: &#x27;üóÉÔ∏è&#x27;
    };
    return iconMap[bulkUnit] || &#x27;üì¶&#x27;;
  }

  /**
   * V√©rifie si une entr√©e est r√©cente (moins de 7 jours)
   * @param entry Entr√©e √† v√©rifier
   * @returns true si r√©cente
   */
  isRecentEntry(entry: StockEntry): boolean {
    const sevenDaysAgo &#x3D; new Date();
    sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
    return new Date(entry.date) &gt;&#x3D; sevenDaysAgo;
  }

  /**
   * V√©rifie si la date de p√©remption approche (moins de 30 jours)
   * @param entry Entr√©e √† v√©rifier
   * @returns true si la p√©remption approche
   */
  isExpiryApproaching(entry: StockEntry): boolean {
    if (!entry.expiryDate) return false;

    const thirtyDaysFromNow &#x3D; new Date();
    thirtyDaysFromNow.setDate(thirtyDaysFromNow.getDate() + 30);

    return new Date(entry.expiryDate) &lt;&#x3D; thirtyDaysFromNow;
  }

  /**
   * Calcule le nombre de jours avant la p√©remption
   * @param expiryDate Date de p√©remption
   * @returns Nombre de jours restants
   */
  getDaysUntilExpiry(expiryDate: Date): number {
    const now &#x3D; new Date();
    const expiry &#x3D; new Date(expiryDate);
    const diff &#x3D; expiry.getTime() - now.getTime();
    return Math.ceil(diff / (1000 * 60 * 60 * 24));
  }
}
</code></pre>
    </div>
</div>








                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

          <label class="dark-mode-switch">
               <input type="checkbox">
               <span class="slider">
                    <svg class="slider-icon" viewBox="0 0 24 24" fill="none" height="20" stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" width="20" xmlns="http://www.w3.org/2000/svg">
                    <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
                    </svg>
               </span>
          </label>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'WinePairingSuggestion.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script>
               $darkModeToggleSwitchers = document.querySelectorAll('.dark-mode-switch input');
               checkToggle(darkModeState);
               if ($darkModeToggleSwitchers.length > 0) {
                    for (var i = 0; i < $darkModeToggleSwitchers.length; i++) {
                         $darkModeToggleSwitchers[i].addEventListener('change', function (event) {
                              darkModeState = !darkModeState;
                              toggleDarkMode(darkModeState);
                         });
                    }
               }
          </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>

       <script src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
