<!-- ===== PAGE PROFIL UTILISATEUR ===== -->
<div class="page-section">

  <section class="content-section">

    <!-- En-tÃªte de la page -->
    <div class="section-header">
      <h2 class="section-title-main">ğŸ‘¤ Mon Profil</h2>

      <!-- Bouton mode Ã©dition -->
      <div class="header-actions">
        <button class="btn btn-secondary"
                *ngIf="!isEditMode"
                (click)="enableEditMode()">
          âœï¸ Modifier le profil
        </button>

        <button class="btn btn-cancel"
                *ngIf="isEditMode"
                (click)="cancelEdit()">
          âŒ Annuler
        </button>
      </div>
    </div>

    <!-- ===== Carte principale du profil ===== -->
    <div class="profile-card">

      <!-- En-tÃªte avec avatar et informations de base -->
      <div class="profile-header">

        <!-- Avatar de l'utilisateur -->
        <div class="profile-avatar-container">
          <div class="profile-avatar-large">{{ userProfile.avatar }}</div>

          <!-- Bouton pour changer l'avatar (visible en mode Ã©dition) -->
          <button class="change-avatar-btn"
                  *ngIf="isEditMode"
                  (click)="changeAvatar()">
            ğŸ“· Changer
          </button>
        </div>

        <!-- Informations principales -->
        <div class="profile-basic-info">
          <h3>{{ userProfile.firstName }} {{ userProfile.lastName }}</h3>
          <p class="profile-role-badge">{{ userProfile.role }}</p>
          <p class="profile-join-date">
            ğŸ‘‹ Membre depuis le {{ userProfile.joinDate }}
            <span class="days-badge">({{ getDaysSinceJoin() }} jours)</span>
          </p>
        </div>
      </div>

      <!-- ===== Formulaire d'Ã©dition du profil ===== -->
      <div class="profile-form-section">
        <h4 class="section-subtitle">ğŸ“‹ Informations personnelles</h4>

        <form class="profile-form">

          <!-- Ligne avec 2 champs: PrÃ©nom et Nom -->
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">PrÃ©nom *</label>
              <input type="text"
                     class="form-input"
                     [(ngModel)]="userProfile.firstName"
                     name="firstName"
                     [disabled]="!isEditMode"
                     [class.disabled]="!isEditMode"
                     required>
            </div>

            <div class="form-group">
              <label class="form-label">Nom *</label>
              <input type="text"
                     class="form-input"
                     [(ngModel)]="userProfile.lastName"
                     name="lastName"
                     [disabled]="!isEditMode"
                     [class.disabled]="!isEditMode"
                     required>
            </div>
          </div>

          <!-- Champ Email -->
          <div class="form-group">
            <label class="form-label">Email *</label>
            <input type="email"
                   class="form-input"
                   [(ngModel)]="userProfile.email"
                   name="email"
                   [disabled]="!isEditMode"
                   [class.disabled]="!isEditMode"
                   required>
          </div>

          <!-- Champ TÃ©lÃ©phone -->
          <div class="form-group">
            <label class="form-label">TÃ©lÃ©phone</label>
            <input type="tel"
                   class="form-input"
                   [(ngModel)]="userProfile.phone"
                   name="phone"
                   [disabled]="!isEditMode"
                   [class.disabled]="!isEditMode">
          </div>

          <!-- Champ RÃ´le (non modifiable) -->
          <div class="form-group">
            <label class="form-label">RÃ´le</label>
            <input type="text"
                   class="form-input disabled"
                   [value]="userProfile.role"
                   disabled>
            <small class="form-hint">âš ï¸ Le rÃ´le ne peut pas Ãªtre modifiÃ©</small>
          </div>
        </form>
      </div>

      <!-- ===== Section Changement de mot de passe ===== -->
      <div class="password-section">

        <!-- En-tÃªte avec bouton toggle -->
        <div class="password-header" (click)="togglePasswordSection()">
          <h4 class="section-subtitle">ğŸ”’ Changer le mot de passe</h4>
          <span class="toggle-icon">{{ isPasswordSectionOpen ? 'â–²' : 'â–¼' }}</span>
        </div>

        <!-- Formulaire de mot de passe (affichÃ© conditionnellement) -->
        <div class="password-form" *ngIf="isPasswordSectionOpen">
          <form>

            <!-- Mot de passe actuel -->
            <div class="form-group">
              <label class="form-label">Mot de passe actuel *</label>
              <input type="password"
                     class="form-input"
                     [(ngModel)]="passwordForm.currentPassword"
                     name="currentPassword"
                     placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                     required>
            </div>

            <!-- Nouveau mot de passe -->
            <div class="form-group">
              <label class="form-label">Nouveau mot de passe *</label>
              <input type="password"
                     class="form-input"
                     [(ngModel)]="passwordForm.newPassword"
                     name="newPassword"
                     placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                     required>
              <small class="form-hint">Minimum 8 caractÃ¨res</small>
            </div>

            <!-- Confirmation du mot de passe -->
            <div class="form-group">
              <label class="form-label">Confirmer le mot de passe *</label>
              <input type="password"
                     class="form-input"
                     [(ngModel)]="passwordForm.confirmPassword"
                     name="confirmPassword"
                     placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"
                     required>
            </div>

            <!-- Bouton de changement -->
            <button type="button"
                    class="btn btn-primary btn-block"
                    (click)="changePassword()">
              ğŸ”‘ Changer le mot de passe
            </button>
          </form>
        </div>
      </div>

      <!-- ===== Statistiques du profil ===== -->
      <div class="profile-stats-section">
        <h4 class="section-subtitle">ğŸ“Š Mes Statistiques</h4>

        <div class="profile-stats-grid">

          <!-- Stat: Caves gÃ©rÃ©es -->
          <div class="profile-stat-item">
            <div class="profile-stat-icon">ğŸ·</div>
            <div class="profile-stat-value">{{ userProfile.stats.caves }}</div>
            <div class="profile-stat-label">Caves gÃ©rÃ©es</div>
          </div>

          <!-- Stat: Managers -->
          <div class="profile-stat-item">
            <div class="profile-stat-icon">ğŸ‘¥</div>
            <div class="profile-stat-value">{{ userProfile.stats.managers }}</div>
            <div class="profile-stat-label">Managers</div>
          </div>

          <!-- Stat: EmployÃ©s -->
          <div class="profile-stat-item">
            <div class="profile-stat-icon">ğŸ‘¨â€ğŸ’¼</div>
            <div class="profile-stat-value">{{ userProfile.stats.employees }}</div>
            <div class="profile-stat-label">EmployÃ©s</div>
          </div>

          <!-- Stat: Ventes totales -->
          <div class="profile-stat-item">
            <div class="profile-stat-icon">ğŸ’°</div>
            <div class="profile-stat-value">{{ userProfile.stats.totalSales }}</div>
            <div class="profile-stat-label">Ventes totales</div>
          </div>
        </div>
      </div>

      <!-- ===== Actions du compte ===== -->
      <div class="account-actions-section">
        <h4 class="section-subtitle">âš™ï¸ Actions du compte</h4>

        <div class="account-actions-grid">

          <!-- Bouton: Exporter les donnÃ©es -->
          <button class="action-btn action-btn-info" (click)="exportAccountData()">
            <div class="action-icon">ğŸ“¥</div>
            <div class="action-content">
              <div class="action-title">Exporter mes donnÃ©es</div>
              <div class="action-description">TÃ©lÃ©charger toutes vos informations</div>
            </div>
          </button>

          <!-- Bouton: Supprimer le compte -->
          <button class="action-btn action-btn-danger" (click)="deleteAccount()">
            <div class="action-icon">ğŸ—‘ï¸</div>
            <div class="action-content">
              <div class="action-title">Supprimer mon compte</div>
              <div class="action-description">Action irrÃ©versible</div>
            </div>
          </button>
        </div>
      </div>

      <!-- ===== Bouton de sauvegarde (visible en mode Ã©dition) ===== -->
      <div class="profile-footer" *ngIf="isEditMode">
        <button class="btn btn-primary btn-large" (click)="saveProfile()">
          ğŸ’¾ Enregistrer les modifications
        </button>
      </div>
    </div>
  </section>
</div>
