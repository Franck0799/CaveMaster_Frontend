<!-- ==========================================
     TEMPLATE HTML (employees.component.html)
     ========================================== -->

<div class="employees-container">

  <!-- EN-TÃŠTE -->
  <header class="page-header">
    <div class="header-content">
      <h1 class="page-title">ğŸ‘¨â€ğŸ’¼ Mes EmployÃ©s</h1>
      <p class="page-subtitle">
        GÃ©rez tous vos employÃ©s - {{ filteredEmployees.length }} employÃ©(s)
      </p>
    </div>
    <button class="btn btn-primary" (click)="openAddModal()">
      â• Ajouter un employÃ©
    </button>
  </header>

  <!-- STATISTIQUES -->
  <section class="stats-section">
    <div class="stat-card stat-primary">
      <div class="stat-icon">ğŸ‘¥</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.total }}</div>
        <div class="stat-label">Total employÃ©s</div>
      </div>
    </div>

    <div class="stat-card stat-success">
      <div class="stat-icon">ğŸ’°</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.avgSales }}</div>
        <div class="stat-label">Ventes moyennes</div>
      </div>
    </div>

    <div class="stat-card stat-info">
      <div class="stat-icon">â±ï¸</div>
      <div class="stat-content">
        <div class="stat-value">{{ stats.avgHours }}</div>
        <div class="stat-label">Heures moyennes</div>
      </div>
    </div>

    <div class="stat-card stat-warning">
      <div class="stat-icon">âœ¨</div>
      <div class="stat-content">
        <div class="stat-value">+{{ stats.newThisMonth }}</div>
        <div class="stat-label">Nouveaux ce mois</div>
      </div>
    </div>
  </section>

  <!-- FILTRES -->
  <section class="filters-section">
    <div class="search-box">
      <input type="text" class="search-input"
             placeholder="ğŸ” Rechercher..."
             [(ngModel)]="searchTerm"
             (ngModelChange)="onSearchChange($event)">
      <button *ngIf="searchTerm"
              class="clear-btn"
              (click)="searchTerm = ''; onSearchChange('')">âœ•</button>
    </div>

    <div class="filter-group">
      <label class="filter-label">Cave :</label>
      <select class="filter-select"
              [(ngModel)]="selectedCaveFilter"
              (ngModelChange)="onCaveFilterChange($event)">
        <option [ngValue]="null">Toutes les caves</option>
        <option *ngFor="let cave of caves" [ngValue]="cave.id">
          {{ cave.name }}
        </option>
      </select>
    </div>

    <div class="filter-group" *ngIf="selectedCaveFilter">
      <label class="filter-label">Manager :</label>
      <select class="filter-select"
              [(ngModel)]="selectedManagerFilter"
              (ngModelChange)="onManagerFilterChange($event)">
        <option [ngValue]="null">Tous les managers</option>
        <option *ngFor="let manager of getManagersByCave(selectedCaveFilter)"
                [ngValue]="manager.name">
          {{ manager.name }}
        </option>
      </select>
    </div>

    <button class="btn btn-secondary"
            (click)="resetFilters()"
            *ngIf="selectedCaveFilter || selectedManagerFilter || searchTerm">
      ğŸ”„ RÃ©initialiser
    </button>
  </section>

  <!-- CHARGEMENT -->
  <div *ngIf="isLoading" class="loading-spinner">
    <div class="spinner"></div>
    <p>Chargement des employÃ©s...</p>
  </div>

  <!-- TABLEAU DES EMPLOYÃ‰S -->
  <section *ngIf="!isLoading && filteredEmployees.length > 0"
           class="employees-table">
    <div class="table-wrapper">
      <table class="data-table">
        <thead>
          <tr>
            <th>EmployÃ©</th>
            <th>Poste</th>
            <th>Manager</th>
            <th>Cave</th>
            <th class="text-center">Ventes</th>
            <th class="text-center">Heures</th>
            <th class="text-center">Actions</th>
          </tr>
        </thead>

        <tbody>
          <tr *ngFor="let employee of filteredEmployees" class="table-row">
            <td class="employee-cell">
              <div class="employee-avatar">{{ employee.avatar }}</div>
              <div class="employee-info">
                <div class="employee-name">{{ employee.name }}</div>
                <div class="employee-email">{{ employee.email }}</div>
              </div>
            </td>

            <td><span class="position-badge">{{ employee.position }}</span></td>
            <td>{{ getManagerName(employee.managerId) }}</td>
            <td><span class="cave-badge">ğŸ“ {{ getCaveName(employee.caveId) }}</span></td>
            <td class="text-center"><span class="sales-badge">ğŸ’° {{ employee.ventes }}</span></td>
            <td class="text-center"><span class="hours-badge">â±ï¸ {{ employee.heures }}</span></td>

            <td class="text-center actions-cell">
              <button class="btn-icon" title="Modifier">âœï¸</button>
              <button class="btn-icon" title="DÃ©tails">ğŸ‘ï¸</button>
              <button class="btn-icon btn-danger"
                      title="Supprimer"
                      (click)="deleteEmployee(employee)">ğŸ—‘ï¸</button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </section>

  <!-- MODAL AJOUT EMPLOYÃ‰ -->
  <div *ngIf="isAddModalOpen" class="modal-overlay" (click)="closeAddModal()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <header class="modal-header">
        <h2 class="modal-title">â• Ajouter un EmployÃ©</h2>
        <button class="modal-close-btn" (click)="closeAddModal()">âœ•</button>
      </header>

      <div class="modal-body">
        <form class="employee-form">
          <div class="form-row">
            <div class="form-group">
              <label class="form-label">PrÃ©nom <span class="required">*</span></label>
              <input type="text" class="form-input"
                     [(ngModel)]="employeeForm.firstName"
                     name="firstName" placeholder="Alice" required>
            </div>

            <div class="form-group">
              <label class="form-label">Nom <span class="required">*</span></label>
              <input type="text" class="form-input"
                     [(ngModel)]="employeeForm.lastName"
                     name="lastName" placeholder="Martin" required>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label">Email <span class="required">*</span></label>
            <input type="email" class="form-input"
                   [(ngModel)]="employeeForm.email"
                   name="email"
                   placeholder="alice.martin@drinkstore.com" required>
          </div>

          <div class="form-group">
            <label class="form-label">TÃ©lÃ©phone</label>
            <input type="tel" class="form-input"
                   [(ngModel)]="employeeForm.phone"
                   name="phone"
                   placeholder="+234 801 234 5678">
          </div>

          <div class="form-group">
            <label class="form-label">Cave d'affectation <span class="required">*</span></label>
            <select class="form-input"
                    [(ngModel)]="employeeForm.caveId"
                    name="caveId" required>
              <option value="">SÃ©lectionner une cave...</option>
              <option *ngFor="let cave of caves" [value]="cave.id">
                {{ cave.name }}
              </option>
            </select>
          </div>

          <div class="form-group" *ngIf="employeeForm.caveId">
            <label class="form-label">Manager <span class="required">*</span></label>
            <select class="form-input"
                    [(ngModel)]="employeeForm.managerId"
                    name="managerId" required>
              <option value="">SÃ©lectionner un manager...</option>
              <option *ngFor="let manager of getManagersByCave(employeeForm.caveId)"
                      [value]="manager.name">
                {{ manager.name }} - {{ manager.role }}
              </option>
            </select>
          </div>

          <div class="form-group">
            <label class="form-label">Poste <span class="required">*</span></label>
            <select class="form-input"
                    [(ngModel)]="employeeForm.position"
                    name="position" required>
              <option value="">SÃ©lectionner un poste...</option>
              <option value="Caissier(Ã¨re)">Caissier(Ã¨re)</option>
              <option value="Vendeur(se)">Vendeur(se)</option>
              <option value="Magasinier">Magasinier</option>
              <option value="Livreur">Livreur</option>
              <option value="Assistant(e)">Assistant(e)</option>
              <option value="Sommelier">Sommelier</option>
              <option value="Conseiller(Ã¨re)">Conseiller(Ã¨re)</option>
            </select>
          </div>
        </form>
      </div>

      <footer class="modal-footer">
        <button class="btn btn-cancel" (click)="closeAddModal()">Annuler</button>
        <button class="btn btn-primary" (click)="saveEmployee()">
          ğŸ’¾ Ajouter l'employÃ©
        </button>
      </footer>
    </div>
  </div>

  <!-- AUCUN RÃ‰SULTAT -->
  <div *ngIf="!isLoading && filteredEmployees.length === 0"
       class="no-results">
    <div class="no-results-icon">ğŸ‘¨â€ğŸ’¼</div>
    <h3>Aucun employÃ© trouvÃ©</h3>
    <button class="btn btn-primary" (click)="openAddModal()">
      â• Ajouter un employÃ©
    </button>
  </div>

</div>
