<!-- ===== FICHIER: admin-dashboard.component.html ===== -->
<div class="dashboard" [class.sidebar-open]="isMobileSidebarOpen">

  <!-- ===== OVERLAY MOBILE ===== -->
  <!-- Overlay sombre qui apparaÃ®t sur mobile quand le sidebar est ouvert -->
  <div class="mobile-overlay"
       *ngIf="isMobileSidebarOpen"
       (click)="closeMobileSidebar()"></div>

  <!-- ===== SIDEBAR (MENU LATÃ‰RAL) ===== -->
  <aside class="sidebar" [class.mobile-open]="isMobileSidebarOpen">

    <!-- Logo et bouton fermeture mobile -->
    <div class="sidebar-header">
      <div class="logo">
        <span class="logo-icon">ğŸ¾</span>
        <span class="logo-text">CaveViking Pro</span>
      </div>
    </div>

    <!-- Navigation principale -->
    <nav class="sidebar-section">
      <div class="nav-item"
           [routerLink]="['/admin', 'home']"
           routerLinkActive="active"
           (click)="closeMobileSidebar()">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-text">Accueil</span>
      </div>

      <div class="nav-item"
           [routerLink]="['/admin', 'caves']"
           routerLinkActive="active"
           (click)="closeMobileSidebar()">
        <span class="nav-icon">ğŸ·</span>
        <span class="nav-text">Mes caves</span>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- ===== SECTION MON EQUIPE AVEC SOUS-MENU AU SURVOL ===== -->
    <nav class="sidebar-section">
      <!-- Titre de section avec Ã©vÃ©nements de survol -->
      <!-- (mouseenter) se dÃ©clenche quand la souris entre dans l'Ã©lÃ©ment -->
      <!-- (mouseleave) se dÃ©clenche quand la souris quitte l'Ã©lÃ©ment -->
      <div class="section-title-hover"
           (mouseenter)="onSectionMouseEnter('team')"
           (mouseleave)="onSectionMouseLeave()">
        <div class="section-title">MON EQUIPE</div>
        <!-- Indicateur visuel que c'est un menu dÃ©roulant -->

      </div>

      <!-- Sous-menu qui apparaÃ®t au survol -->
      <!-- [class.show] ajoute la classe "show" si isSubmenuOpen('team') retourne true -->
      <!-- Les Ã©vÃ©nements mouse maintiennent le menu ouvert quand on survole le sous-menu -->
      <div class="hover-submenu"
           [class.show]="isSubmenuOpen('team')"
           (mouseenter)="onSubmenuMouseEnter()"
           (mouseleave)="onSubmenuMouseLeave()">

        <!-- Items du sous-menu -->
        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'managers']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ‘¥</span>
          <span class="nav-text">Mes managers</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'employees']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ‘¨â€ğŸ’¼</span>
          <span class="nav-text">Mes employÃ©s</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'client']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ§‘â€ğŸ’¼</span>
          <span class="nav-text">Clients</span>
        </div>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- ===== SECTION PARTENARIAT AVEC SOUS-MENU AU SURVOL ===== -->
    <nav class="sidebar-section">
      <div class="section-title-hover"
           (mouseenter)="onSectionMouseEnter('partnership')"
           (mouseleave)="onSectionMouseLeave()">
        <div class="section-title">PARTENARIAT</div>

      </div>

      <div class="hover-submenu"
           [class.show]="isSubmenuOpen('partnership')"
           (mouseenter)="onSubmenuMouseEnter()"
           (mouseleave)="onSubmenuMouseLeave()">

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'fournisseur']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ­</span>
          <span class="nav-text">Fournisseurs</span>
        </div>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- ===== SECTION MA CAVE AVEC SOUS-MENU AU SURVOL ===== -->
    <nav class="sidebar-section">
      <div class="section-title-hover"
           (mouseenter)="onSectionMouseEnter('cave')"
           (mouseleave)="onSectionMouseLeave()">
        <div class="section-title">MA CAVE</div>

      </div>

      <div class="hover-submenu"
           [class.show]="isSubmenuOpen('cave')"
           (mouseenter)="onSubmenuMouseEnter()"
           (mouseleave)="onSubmenuMouseLeave()">

        <!-- Mes boissons avec sous-menu imbriquÃ© (systÃ¨me au clic conservÃ©) -->
        <div class="nav-item nav-item-with-submenu submenu-item"
             [class.open]="isDrinksSubmenuOpen"
             (click)="toggleDrinksSubmenu($event)">
          <span class="nav-icon">ğŸ¾</span>
          <span class="nav-text">Mes boissons</span>
          <span class="submenu-arrow" [class.rotated]="isDrinksSubmenuOpen">â–¶</span>
        </div>

        <!-- Sous-sous-menu des boissons (conserve le systÃ¨me au clic) -->
        <div class="submenu" [class.open]="isDrinksSubmenuOpen">
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'BiÃ¨res']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸº BiÃ¨res
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Sucreries']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ¬ Sucreries
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Champagne']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ¥‚ Champagne
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Vin Blanc']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ· Vin Blanc
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Vin Rouge']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ· Vin Rouge
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Vin RosÃ©']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ· Vin RosÃ©
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Vin Mousseux']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            âœ¨ Vin Mousseux
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Liqueurs']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ¥ƒ Liqueurs
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Boissons Ã‰nergisantes']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            âš¡ Boissons Ã‰nergisantes
          </div>
          <div class="submenu-item"
               [routerLink]="['/admin', 'drinks', 'Boissons Locales']"
               routerLinkActive="active"
               (click)="closeMobileSidebar()">
            ğŸ¹ Boissons Locales
          </div>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'wine-pairing']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ½ï¸</span>
          <span class="nav-text">Mets & Vins</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'scan']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“·</span>
          <span class="nav-text">Scan</span>
        </div>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- ===== SECTION MAGASIN AVEC SOUS-MENU AU SURVOL ===== -->
    <nav class="sidebar-section">
      <div class="section-title-hover"
           (mouseenter)="onSectionMouseEnter('store')"
           (mouseleave)="onSectionMouseLeave()">
        <div class="section-title">MAGASIN</div>

      </div>

      <div class="hover-submenu"
           [class.show]="isSubmenuOpen('store')"
           (mouseenter)="onSubmenuMouseEnter()"
           (mouseleave)="onSubmenuMouseLeave()">

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'materiel']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ”§</span>
          <span class="nav-text">MatÃ©riels</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'stock']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“¦</span>
          <span class="nav-text">Stocks gÃ©nÃ©ral</span>
        </div>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- ===== SECTION FINANCE AVEC SOUS-MENU AU SURVOL ===== -->
    <nav class="sidebar-section">
      <div class="section-title-hover"
           (mouseenter)="onSectionMouseEnter('finance')"
           (mouseleave)="onSectionMouseLeave()">
        <div class="section-title">FINANCE</div>

      </div>

      <div class="hover-submenu"
           [class.show]="isSubmenuOpen('finance')"
           (mouseenter)="onSubmenuMouseEnter()"
           (mouseleave)="onSubmenuMouseLeave()">

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'entries']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“¥</span>
          <span class="nav-text">Mes entrÃ©es</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'exits']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“¤</span>
          <span class="nav-text">Mes sorties</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin','caisse']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ’µ</span>
          <span class="nav-text">Caisse</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'depenses']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ’³</span>
          <span class="nav-text">DÃ©penses</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'profit']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ’°</span>
          <span class="nav-text">BÃ©nÃ©fices</span>
        </div>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- ===== SECTION INFOS AVEC SOUS-MENU AU SURVOL ===== -->
    <nav class="sidebar-section">
      <div class="section-title-hover"
           (mouseenter)="onSectionMouseEnter('info')"
           (mouseleave)="onSectionMouseLeave()">
        <div class="section-title">INFOS</div>

      </div>

      <div class="hover-submenu"
           [class.show]="isSubmenuOpen('info')"
           (mouseenter)="onSubmenuMouseEnter()"
           (mouseleave)="onSubmenuMouseLeave()">

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'faq']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">â“</span>
          <span class="nav-text">FAQ</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'improvements']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“</span>
          <span class="nav-text">Notes amÃ©liorations</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'contact']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“§</span>
          <span class="nav-text">Nous contacter</span>
        </div>

        <div class="nav-item submenu-item"
             [routerLink]="['/admin', 'about']"
             routerLinkActive="active"
             (click)="closeMobileSidebar()">
          <span class="nav-icon">ğŸ“š</span>
          <span class="nav-text">En savoir plus</span>
        </div>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- Navigation compte utilisateur (pas de sous-menu) -->
    <nav class="sidebar-section">
      <div class="nav-item"
           [routerLink]="['/admin', 'profile']"
           routerLinkActive="active"
           (click)="closeMobileSidebar()">
        <span class="nav-icon">ğŸ‘¤</span>
        <span class="nav-text">Mon compte</span>
      </div>
    </nav>

    <div class="divider"></div>

    <!-- RÃ©seaux sociaux -->
    <div class="sidebar-section">
      <div class="section-title">SUIVEZ-NOUS</div>
      <div class="social-links">
        <a  href="https://facebook.com" target="_blank" rel="noopener" class="social-link" aria-label="Facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
        <a href="https://twitter.com" target="_blank" rel="noopener" class="social-link" aria-label="Twitter">
          <i class="fab fa-twitter"></i>
        </a>
        <a href="https://linkedin.com" target="_blank" rel="noopener" class="social-link" aria-label="LinkedIn">
          <i class="fab fa-linkedin-in"></i>
        </a>
        <a href="https://instagram.com" target="_blank" rel="noopener" class="social-link" aria-label="Instagram">
          <i class="fab fa-instagram"></i>
        </a>
      </div>
    </div>

    <div class="divider"></div>

    <!-- Version -->
    <div class="sidebar-footer">
      <p class="version-text">Version 2.0.0</p>
      <p class="copyright-text">Â© 2025 CaveViking Pro</p>
    </div>
  </aside>

  <!-- ===== CONTENU PRINCIPAL ===== -->
  <main class="main-content">

    <!-- En-tÃªte du haut -->
    <header class="top-header">

      <!-- Barre de recherche -->
      <div class="header-left">
        <div class="search-bar">
          <input
            type="text"
            placeholder="Rechercher un vin, millÃ©sime, une cave..."
            [(ngModel)]="searchTerm"
            (keyup.enter)="onSearch()"
            aria-label="Recherche">
          <button class="search-btn" (click)="onSearch()" aria-label="Rechercher">
            ğŸ”
          </button>
        </div>
      </div>

      <!-- Ã‰lÃ©ments Ã  droite -->
      <div class="header-right">
        <!-- Composant de changement de thÃ¨me -->
        <app-theme-toggle></app-theme-toggle>

        <!-- SÃ©lecteur de catÃ©gories -->
        <div class="category-selector"></div>

        <!-- IcÃ´ne messages -->
        <div class="header-icon"
             [routerLink]="['/admin', 'messages']"
             role="button"
             tabindex="0"
             aria-label="Messages">
          <span class="icon">ğŸ’¬</span>
          <span class="badge" *ngIf="getUnreadMessagesCount() > 0">
            {{ getUnreadMessagesCount() }}
          </span>
        </div>

        <!-- IcÃ´ne notifications -->
        <div class="header-icon"
             [routerLink]="['/admin', 'notifications']"
             role="button"
             tabindex="0"
             aria-label="Notifications">
          <span class="icon">ğŸ””</span>
          <span class="badge" *ngIf="getUnreadNotificationsCount() > 0">
            {{ getUnreadNotificationsCount() }}
          </span>
        </div>

        <!-- Profil utilisateur avec dropdown -->
        <div class="user-profile"
             (click)="toggleUserDropdown($event)"
             role="button"
             tabindex="0"
             aria-label="Profil utilisateur">
          <div class="avatar">{{ userProfile.avatar }}</div>
          <div class="user-info">
            <div class="user-name">{{ userProfile.firstName }} {{ userProfile.lastName }}</div>
            <div class="user-role">{{ userProfile.role }}</div>
          </div>
          <span class="dropdown-arrow" [class.rotated]="isUserDropdownOpen">â–¼</span>

          <!-- Menu dropdown -->
          <div class="user-dropdown"
               [class.show]="isUserDropdownOpen"
               (click)="$event.stopPropagation()">
            <div class="dropdown-item"
                 [routerLink]="['/admin', 'profile']"
                 (click)="isUserDropdownOpen = false">
              <span class="dropdown-icon">ğŸ‘¤</span>
              <span>Mon profil</span>
            </div>
            <div class="dropdown-item"
                 [routerLink]="['/admin', 'settings']"
                 (click)="isUserDropdownOpen = false">
              <span class="dropdown-icon">âš™ï¸</span>
              <span>ParamÃ¨tres</span>
            </div>
            <div class="dropdown-divider"></div>
            <div class="dropdown-item"
                 [routerLink]="['/admin', 'support']"
                 (click)="isUserDropdownOpen = false">
              <span class="dropdown-icon">ğŸ’¬</span>
              <span>Assistance</span>
            </div>
            <div class="dropdown-item logout-item" (click)="logout($event)">
              <span class="dropdown-icon">ğŸšª</span>
              <span>DÃ©connexion</span>
            </div>
          </div>
        </div>
      </div>
    </header>

    <!-- ===== ROUTER OUTLET - C'EST ICI QUE LES PAGES S'AFFICHENT ===== -->
    <div class="content-wrapper">
      <router-outlet></router-outlet>
    </div>

    <!-- Footer -->
    <footer class="main-footer">
      <div class="footer-content">
        <p class="footer-text">
          Â© 2025 CaveViking Pro - Tous droits rÃ©servÃ©s
        </p>
        <div class="footer-links">
          <a [routerLink]="['/admin', 'privacy']" class="footer-link">ConfidentialitÃ©</a>
          <span class="separator">â€¢</span>
          <a [routerLink]="['/admin', 'terms']" class="footer-link">Conditions</a>
          <span class="separator">â€¢</span>
          <a [routerLink]="['/admin', 'contact']" class="footer-link">Contact</a>
        </div>
      </div>
    </footer>
  </main>
</div>
