
<div class="inventory-page">
  <div class="page-header">
    <div>
      <h1 class="page-title">Inventaire</h1>
      <p class="page-subtitle">DerniÃ¨re mise Ã  jour: {{ lastUpdate | date:'dd/MM/yyyy HH:mm' }}</p>
    </div>
    <div class="header-actions">
      <button class="btn-secondary" (click)="exportInventory()">
        ğŸ“¥ Exporter
      </button>
      <button class="btn-primary" (click)="startInventory()">
        ğŸ“‹ Nouvel inventaire
      </button>
    </div>
  </div>

  <!-- Filtres -->
  <div class="filters">
    <select class="filter-select" [(ngModel)]="selectedCategory" (change)="applyFilters()">
      <option value="all">Toutes catÃ©gories</option>
      <option value="Vin Rouge">Vin Rouge</option>
      <option value="Vin Blanc">Vin Blanc</option>
      <option value="Champagne">Champagne</option>
      <option value="Spiritueux">Spiritueux</option>
    </select>

    <input type="text"
           class="search-input"
           placeholder="Rechercher un produit..."
           [(ngModel)]="searchTerm"
           (input)="applyFilters()">
  </div>

  <!-- Tableau d'inventaire -->
  <div class="inventory-table">
    <div class="table-header">
      <div class="col-name">Produit</div>
      <div class="col-category">CatÃ©gorie</div>
      <div class="col-stock">Stock</div>
      <div class="col-unit">UnitÃ©</div>
      <div class="col-last">Dernier inventaire</div>
      <div class="col-variance">Ã‰cart</div>
      <div class="col-actions">Actions</div>
    </div>

    <div class="table-row" *ngFor="let item of filteredItems">
      <div class="col-name">
        <span class="product-name">{{ item.name }}</span>
      </div>
      <div class="col-category">
        <span class="category-badge">{{ item.category }}</span>
      </div>
      <div class="col-stock">
        <input type="number"
               class="stock-input"
               [(ngModel)]="item.stock"
               (change)="updateStock(item)">
      </div>
      <div class="col-unit">
        <span class="unit-text">{{ item.unit }}</span>
      </div>
      <div class="col-last">
        <span class="date-text">{{ item.lastInventory | date:'dd/MM/yyyy' }}</span>
      </div>
      <div class="col-variance">
        <span class="variance-value"
              [class.positive]="item.variance > 0"
              [class.negative]="item.variance < 0">
          {{ item.variance > 0 ? '+' : '' }}{{ item.variance }}
        </span>
      </div>
      <div class="col-actions">
        <button class="icon-btn" (click)="viewHistory(item)" title="Historique">ğŸ“Š</button>
        <button class="icon-btn" (click)="adjustStock(item)" title="Ajuster">âœï¸</button>
      </div>
    </div>
  </div>
</div>
<!-- ===== INVENTORY - MODAL AJUSTEMENT STOCK ===== -->
<div class="modal-overlay" *ngIf="showAdjustModal" (click)="closeAdjustModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2 class="modal-title">Ajuster le stock</h2>
      <button class="btn-close" (click)="closeAdjustModal()">âœ•</button>
    </div>

    <div class="modal-body" *ngIf="selectedItem">
      <div class="product-info-header">
        <h3>{{ selectedItem.name }}</h3>
        <span class="category-badge">{{ selectedItem.category }}</span>
      </div>

      <div class="stock-comparison">
        <div class="stock-item">
          <span class="stock-label">Stock actuel</span>
          <span class="stock-value current">{{ selectedItem.stock }}</span>
        </div>
        <div class="stock-arrow">â†’</div>
        <div class="stock-item">
          <span class="stock-label">Nouveau stock</span>
          <input type="number" [(ngModel)]="adjustForm.newStock" class="stock-input-large" min="0">
        </div>
      </div>

      <div class="form-group">
        <label for="adjust-reason">Raison de l'ajustement *</label>
        <select id="adjust-reason" [(ngModel)]="adjustForm.reason" class="form-select">
          <option value="">SÃ©lectionner une raison</option>
          <option value="Inventaire physique">Inventaire physique</option>
          <option value="Erreur de saisie">Erreur de saisie</option>
          <option value="Casse/Perte">Casse/Perte</option>
          <option value="Vol">Vol</option>
          <option value="Retour fournisseur">Retour fournisseur</option>
          <option value="Autre">Autre</option>
        </select>
      </div>

      <div class="form-group">
        <label for="adjust-notes">Notes complÃ©mentaires</label>
        <textarea id="adjust-notes" [(ngModel)]="adjustForm.notes" class="form-textarea" rows="3"></textarea>
      </div>

      <div class="alert-info" *ngIf="adjustForm.newStock !== selectedItem.stock">
        <strong>Ã‰cart:</strong>
        <span [class.text-success]="adjustForm.newStock > selectedItem.stock"
              [class.text-danger]="adjustForm.newStock < selectedItem.stock">
          {{ adjustForm.newStock > selectedItem.stock ? '+' : '' }}{{ adjustForm.newStock - selectedItem.stock }}
        </span>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-secondary" (click)="closeAdjustModal()">Annuler</button>
      <button class="btn-primary" (click)="performAdjustStock()">âœ… Valider l'ajustement</button>
    </div>
  </div>
</div>
